{"sources": {"/workspaces/evm-ctf-challenges/challenges/03-Telephone/echidna/TelephoneEchidna.sol": {"AST": {"absolutePath": "echidna/TelephoneEchidna.sol", "exportedSymbols": {"Helper": [125], "Telephone": [192], "TelephoneEchidna": [95]}, "id": 126, "license": "MIT", "nodeType": "SourceUnit", "nodes": [{"id": 1, "literals": ["solidity", "^", "0.8", ".18"], "nodeType": "PragmaDirective", "src": "32:24:0"}, {"absolutePath": "src/Telephone.sol", "file": "../src/Telephone.sol", "id": 2, "nameLocation": "-1:-1:-1", "nodeType": "ImportDirective", "scope": 126, "sourceUnit": 193, "src": "58:30:0", "symbolAliases": [], "unitAlias": ""}, {"abstract": false, "baseContracts": [], "canonicalName": "TelephoneEchidna", "contractDependencies": [125, 192], "contractKind": "contract", "documentation": {"id": 3, "nodeType": "StructuredDocumentation", "src": "90:204:0", "text": " @title TelephoneEchidna\n @notice Property-based testing for Telephone contract using Echidna\n @dev This demonstrates that Echidna CAN find tx.origin vulnerabilities when properly configured"}, "fullyImplemented": true, "id": 95, "linearizedBaseContracts": [95], "name": "TelephoneEchidna", "nameLocation": "304:16:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "functionSelector": "93acaa59", "id": 6, "mutability": "mutable", "name": "telephone", "nameLocation": "344:9:0", "nodeType": "VariableDeclaration", "scope": 95, "src": "327:26:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}, "typeName": {"id": 5, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 4, "name": "Telephone", "nameLocations": ["327:9:0"], "nodeType": "IdentifierPath", "referencedDeclaration": 192, "src": "327:9:0"}, "referencedDeclaration": 192, "src": "327:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "visibility": "public"}, {"constant": false, "functionSelector": "a36250d8", "id": 8, "mutability": "immutable", "name": "INITIAL_OWNER", "nameLocation": "384:13:0", "nodeType": "VariableDeclaration", "scope": 95, "src": "359:38:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 7, "name": "address", "nodeType": "ElementaryTypeName", "src": "359:7:0", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "public"}, {"constant": false, "functionSelector": "63b0e66a", "id": 11, "mutability": "mutable", "name": "helper", "nameLocation": "474:6:0", "nodeType": "VariableDeclaration", "scope": 95, "src": "460:20:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_Helper_$125", "typeString": "contract Helper"}, "typeName": {"id": 10, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9, "name": "Helper", "nameLocations": ["460:6:0"], "nodeType": "IdentifierPath", "referencedDeclaration": 125, "src": "460:6:0"}, "referencedDeclaration": 125, "src": "460:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Helper_$125", "typeString": "contract Helper"}}, "visibility": "public"}, {"body": {"id": 38, "nodeType": "Block", "src": "505:136:0", "statements": [{"expression": {"id": 19, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 14, "name": "telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "515:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [], "expression": {"argumentTypes": [], "id": 17, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "NewExpression", "src": "527:13:0", "typeDescriptions": {"typeIdentifier": "t_function_creation_nonpayable$__$returns$_t_contract$_Telephone_$192_$", "typeString": "function () returns (contract Telephone)"}, "typeName": {"id": 16, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 15, "name": "Telephone", "nameLocations": ["531:9:0"], "nodeType": "IdentifierPath", "referencedDeclaration": 192, "src": "531:9:0"}, "referencedDeclaration": 192, "src": "531:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}}, "id": 18, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "527:15:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "src": "515:27:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "id": 20, "nodeType": "ExpressionStatement", "src": "515:27:0"}, {"expression": {"id": 25, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 21, "name": "INITIAL_OWNER", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "552:13:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 22, "name": "telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "568:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "id": 23, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "578:5:0", "memberName": "owner", "nodeType": "MemberAccess", "referencedDeclaration": 130, "src": "568:15:0", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_address_$", "typeString": "function () view external returns (address)"}}, "id": 24, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "568:17:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "src": "552:33:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 26, "nodeType": "ExpressionStatement", "src": "552:33:0"}, {"expression": {"id": 36, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 27, "name": "helper", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11, "src": "595:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Helper_$125", "typeString": "contract Helper"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"arguments": [{"id": 33, "name": "telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "623:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}], "id": 32, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "615:7:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": {"id": 31, "name": "address", "nodeType": "ElementaryTypeName", "src": "615:7:0", "typeDescriptions": {}}}, "id": 34, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "615:18:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 30, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "NewExpression", "src": "604:10:0", "typeDescriptions": {"typeIdentifier": "t_function_creation_nonpayable$_t_address_$returns$_t_contract$_Helper_$125_$", "typeString": "function (address) returns (contract Helper)"}, "typeName": {"id": 29, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 28, "name": "Helper", "nameLocations": ["608:6:0"], "nodeType": "IdentifierPath", "referencedDeclaration": 125, "src": "608:6:0"}, "referencedDeclaration": 125, "src": "608:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Helper_$125", "typeString": "contract Helper"}}}, "id": 35, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "604:30:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Helper_$125", "typeString": "contract Helper"}}, "src": "595:39:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Helper_$125", "typeString": "contract Helper"}}, "id": 37, "nodeType": "ExpressionStatement", "src": "595:39:0"}]}, "id": 39, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nameLocation": "-1:-1:-1", "nodeType": "FunctionDefinition", "parameters": {"id": 12, "nodeType": "ParameterList", "parameters": [], "src": "502:2:0"}, "returnParameters": {"id": 13, "nodeType": "ParameterList", "parameters": [], "src": "505:0:0"}, "scope": 95, "src": "491:150:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 51, "nodeType": "Block", "src": "877:58:0", "statements": [{"expression": {"commonType": {"typeIdentifier": "t_address", "typeString": "address"}, "id": 49, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 45, "name": "telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "894:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "id": 46, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "904:5:0", "memberName": "owner", "nodeType": "MemberAccess", "referencedDeclaration": 130, "src": "894:15:0", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_address_$", "typeString": "function () view external returns (address)"}}, "id": 47, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "894:17:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": {"id": 48, "name": "INITIAL_OWNER", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 8, "src": "915:13:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "src": "894:34:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "functionReturnParameters": 44, "id": 50, "nodeType": "Return", "src": "887:41:0"}]}, "documentation": {"id": 40, "nodeType": "StructuredDocumentation", "src": "651:159:0", "text": " @notice Property: Owner should never change (this WILL be violated)\n @dev This property will FAIL when Echidna finds the vulnerability"}, "functionSelector": "e8798d7e", "id": 52, "implemented": true, "kind": "function", "modifiers": [], "name": "echidna_owner_unchanged", "nameLocation": "824:23:0", "nodeType": "FunctionDefinition", "parameters": {"id": 41, "nodeType": "ParameterList", "parameters": [], "src": "847:2:0"}, "returnParameters": {"id": 44, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 43, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 52, "src": "871:4:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 42, "name": "bool", "nodeType": "ElementaryTypeName", "src": "871:4:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}], "src": "870:6:0"}, "scope": 95, "src": "815:120:0", "stateMutability": "view", "virtual": false, "visibility": "public"}, {"body": {"id": 67, "nodeType": "Block", "src": "1143:55:0", "statements": [{"expression": {"commonType": {"typeIdentifier": "t_address", "typeString": "address"}, "id": 65, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 58, "name": "telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "1160:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "id": 59, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1170:5:0", "memberName": "owner", "nodeType": "MemberAccess", "referencedDeclaration": 130, "src": "1160:15:0", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_address_$", "typeString": "function () view external returns (address)"}}, "id": 60, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1160:17:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "BinaryOperation", "operator": "!=", "rightExpression": {"arguments": [{"hexValue": "30", "id": 63, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1189:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}], "id": 62, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "1181:7:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": {"id": 61, "name": "address", "nodeType": "ElementaryTypeName", "src": "1181:7:0", "typeDescriptions": {}}}, "id": 64, "isConstant": false, "isLValue": false, "isPure": true, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1181:10:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "src": "1160:31:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "functionReturnParameters": 57, "id": 66, "nodeType": "Return", "src": "1153:38:0"}]}, "documentation": {"id": 53, "nodeType": "StructuredDocumentation", "src": "945:130:0", "text": " @notice Property: Owner is never zero address\n @dev Should generally pass unless specifically set to zero"}, "functionSelector": "f4540b87", "id": 68, "implemented": true, "kind": "function", "modifiers": [], "name": "echidna_owner_never_zero", "nameLocation": "1089:24:0", "nodeType": "FunctionDefinition", "parameters": {"id": 54, "nodeType": "ParameterList", "parameters": [], "src": "1113:2:0"}, "returnParameters": {"id": 57, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 56, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 68, "src": "1137:4:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 55, "name": "bool", "nodeType": "ElementaryTypeName", "src": "1137:4:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}], "src": "1136:6:0"}, "scope": 95, "src": "1080:118:0", "stateMutability": "view", "virtual": false, "visibility": "public"}, {"body": {"id": 80, "nodeType": "Block", "src": "1426:124:0", "statements": [{"expression": {"arguments": [{"id": 77, "name": "newOwner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 71, "src": "1534:8:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "expression": {"id": 74, "name": "telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "1512:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "id": 76, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1522:11:0", "memberName": "changeOwner", "nodeType": "MemberAccess", "referencedDeclaration": 182, "src": "1512:21:0", "typeDescriptions": {"typeIdentifier": "t_function_external_nonpayable$_t_address_$returns$__$", "typeString": "function (address) external"}}, "id": 78, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1512:31:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 79, "nodeType": "ExpressionStatement", "src": "1512:31:0"}]}, "documentation": {"id": 69, "nodeType": "StructuredDocumentation", "src": "1208:155:0", "text": " @notice Direct call to change owner (will fail due to tx.origin == msg.sender)\n @param newOwner Address to attempt to set as owner"}, "functionSelector": "1b44fe55", "id": 81, "implemented": true, "kind": "function", "modifiers": [], "name": "callChangeOwnerDirectly", "nameLocation": "1377:23:0", "nodeType": "FunctionDefinition", "parameters": {"id": 72, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 71, "mutability": "mutable", "name": "newOwner", "nameLocation": "1409:8:0", "nodeType": "VariableDeclaration", "scope": 81, "src": "1401:16:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 70, "name": "address", "nodeType": "ElementaryTypeName", "src": "1401:7:0", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "1400:18:0"}, "returnParameters": {"id": 73, "nodeType": "ParameterList", "parameters": [], "src": "1426:0:0"}, "scope": 95, "src": "1368:182:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 93, "nodeType": "Block", "src": "1845:177:0", "statements": [{"expression": {"arguments": [{"id": 90, "name": "newOwner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 84, "src": "2006:8:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "expression": {"id": 87, "name": "helper", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11, "src": "1978:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Helper_$125", "typeString": "contract Helper"}}, "id": 89, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1985:20:0", "memberName": "changeOwnerViaHelper", "nodeType": "MemberAccess", "referencedDeclaration": 124, "src": "1978:27:0", "typeDescriptions": {"typeIdentifier": "t_function_external_nonpayable$_t_address_$returns$__$", "typeString": "function (address) external"}}, "id": 91, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1978:37:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 92, "nodeType": "ExpressionStatement", "src": "1978:37:0"}]}, "documentation": {"id": 82, "nodeType": "StructuredDocumentation", "src": "1560:217:0", "text": " @notice Call through helper contract (can succeed due to tx.origin != msg.sender)  \n @param newOwner Address to set as owner\n @dev This creates the vulnerability: tx.origin != msg.sender"}, "functionSelector": "4eb4c474", "id": 94, "implemented": true, "kind": "function", "modifiers": [], "name": "callChangeOwnerThroughHelper", "nameLocation": "1791:28:0", "nodeType": "FunctionDefinition", "parameters": {"id": 85, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 84, "mutability": "mutable", "name": "newOwner", "nameLocation": "1828:8:0", "nodeType": "VariableDeclaration", "scope": 94, "src": "1820:16:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 83, "name": "address", "nodeType": "ElementaryTypeName", "src": "1820:7:0", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "1819:18:0"}, "returnParameters": {"id": 86, "nodeType": "ParameterList", "parameters": [], "src": "1845:0:0"}, "scope": 95, "src": "1782:240:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}], "scope": 126, "src": "295:1729:0", "usedErrors": [], "usedEvents": []}, {"abstract": false, "baseContracts": [], "canonicalName": "Helper", "contractDependencies": [], "contractKind": "contract", "documentation": {"id": 96, "nodeType": "StructuredDocumentation", "src": "2026:94:0", "text": " @title Helper\n @notice Helper contract to create tx.origin != msg.sender scenario"}, "fullyImplemented": true, "id": 125, "linearizedBaseContracts": [125], "name": "Helper", "nameLocation": "2130:6:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "functionSelector": "93acaa59", "id": 99, "mutability": "mutable", "name": "telephone", "nameLocation": "2160:9:0", "nodeType": "VariableDeclaration", "scope": 125, "src": "2143:26:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}, "typeName": {"id": 98, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 97, "name": "Telephone", "nameLocations": ["2143:9:0"], "nodeType": "IdentifierPath", "referencedDeclaration": 192, "src": "2143:9:0"}, "referencedDeclaration": 192, "src": "2143:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "visibility": "public"}, {"body": {"id": 110, "nodeType": "Block", "src": "2212:50:0", "statements": [{"expression": {"id": 108, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 104, "name": "telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 99, "src": "2222:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"id": 106, "name": "_telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 101, "src": "2244:10:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "id": 105, "name": "Telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 192, "src": "2234:9:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_Telephone_$192_$", "typeString": "type(contract Telephone)"}}, "id": 107, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2234:21:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "src": "2222:33:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "id": 109, "nodeType": "ExpressionStatement", "src": "2222:33:0"}]}, "id": 111, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nameLocation": "-1:-1:-1", "nodeType": "FunctionDefinition", "parameters": {"id": 102, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 101, "mutability": "mutable", "name": "_telephone", "nameLocation": "2200:10:0", "nodeType": "VariableDeclaration", "scope": 111, "src": "2192:18:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 100, "name": "address", "nodeType": "ElementaryTypeName", "src": "2192:7:0", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "2191:20:0"}, "returnParameters": {"id": 103, "nodeType": "ParameterList", "parameters": [], "src": "2212:0:0"}, "scope": 125, "src": "2180:82:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 123, "nodeType": "Block", "src": "2519:48:0", "statements": [{"expression": {"arguments": [{"id": 120, "name": "newOwner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 114, "src": "2551:8:0", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "expression": {"id": 117, "name": "telephone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 99, "src": "2529:9:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Telephone_$192", "typeString": "contract Telephone"}}, "id": 119, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2539:11:0", "memberName": "changeOwner", "nodeType": "MemberAccess", "referencedDeclaration": 182, "src": "2529:21:0", "typeDescriptions": {"typeIdentifier": "t_function_external_nonpayable$_t_address_$returns$__$", "typeString": "function (address) external"}}, "id": 121, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2529:31:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 122, "nodeType": "ExpressionStatement", "src": "2529:31:0"}]}, "documentation": {"id": 112, "nodeType": "StructuredDocumentation", "src": "2272:185:0", "text": " @notice Change owner through this helper contract\n @param newOwner New owner address\n @dev When called, tx.origin != msg.sender, so vulnerability triggers"}, "functionSelector": "10a564dc", "id": 124, "implemented": true, "kind": "function", "modifiers": [], "name": "changeOwnerViaHelper", "nameLocation": "2471:20:0", "nodeType": "FunctionDefinition", "parameters": {"id": 115, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 114, "mutability": "mutable", "name": "newOwner", "nameLocation": "2500:8:0", "nodeType": "VariableDeclaration", "scope": 124, "src": "2492:16:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 113, "name": "address", "nodeType": "ElementaryTypeName", "src": "2492:7:0", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "2491:18:0"}, "returnParameters": {"id": 116, "nodeType": "ParameterList", "parameters": [], "src": "2519:0:0"}, "scope": 125, "src": "2462:105:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "external"}], "scope": 126, "src": "2121:448:0", "usedErrors": [], "usedEvents": []}], "src": "32:2537:0"}}, "/workspaces/evm-ctf-challenges/challenges/03-Telephone/src/Telephone.sol": {"AST": {"absolutePath": "src/Telephone.sol", "exportedSymbols": {"Telephone": [192]}, "id": 193, "license": "MIT", "nodeType": "SourceUnit", "nodes": [{"id": 127, "literals": ["solidity", "^", "0.8", ".18"], "nodeType": "PragmaDirective", "src": "32:24:1"}, {"abstract": false, "baseContracts": [], "canonicalName": "Telephone", "contractDependencies": [], "contractKind": "contract", "documentation": {"id": 128, "nodeType": "StructuredDocumentation", "src": "58:299:1", "text": " @title Telephone\n @notice A vulnerable contract that demonstrates tx.origin vs msg.sender confusion\n @dev The vulnerability lies in the changeOwner function which checks tx.origin != msg.sender\n This allows an attacker to change ownership by calling through an intermediary contract"}, "fullyImplemented": true, "id": 192, "linearizedBaseContracts": [192], "name": "Telephone", "nameLocation": "367:9:1", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "functionSelector": "8da5cb5b", "id": 130, "mutability": "mutable", "name": "owner", "nameLocation": "398:5:1", "nodeType": "VariableDeclaration", "scope": 192, "src": "383:20:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 129, "name": "address", "nodeType": "ElementaryTypeName", "src": "383:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "public"}, {"anonymous": false, "eventSelector": "8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0", "id": 136, "name": "OwnershipTransferred", "nameLocation": "416:20:1", "nodeType": "EventDefinition", "parameters": {"id": 135, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 132, "indexed": true, "mutability": "mutable", "name": "previousOwner", "nameLocation": "453:13:1", "nodeType": "VariableDeclaration", "scope": 136, "src": "437:29:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 131, "name": "address", "nodeType": "ElementaryTypeName", "src": "437:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}, {"constant": false, "id": 134, "indexed": true, "mutability": "mutable", "name": "newOwner", "nameLocation": "484:8:1", "nodeType": "VariableDeclaration", "scope": 136, "src": "468:24:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 133, "name": "address", "nodeType": "ElementaryTypeName", "src": "468:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "436:57:1"}, "src": "410:84:1"}, {"body": {"id": 154, "nodeType": "Block", "src": "596:94:1", "statements": [{"expression": {"id": 143, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 140, "name": "owner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "606:5:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"expression": {"id": 141, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "614:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 142, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "618:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "614:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "src": "606:18:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 144, "nodeType": "ExpressionStatement", "src": "606:18:1"}, {"eventCall": {"arguments": [{"arguments": [{"hexValue": "30", "id": 148, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "668:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}], "id": 147, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "660:7:1", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": {"id": 146, "name": "address", "nodeType": "ElementaryTypeName", "src": "660:7:1", "typeDescriptions": {}}}, "id": 149, "isConstant": false, "isLValue": false, "isPure": true, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "660:10:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, {"expression": {"id": 150, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "672:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 151, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "676:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "672:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}, {"typeIdentifier": "t_address", "typeString": "address"}], "id": 145, "name": "OwnershipTransferred", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 136, "src": "639:20:1", "typeDescriptions": {"typeIdentifier": "t_function_event_nonpayable$_t_address_$_t_address_$returns$__$", "typeString": "function (address,address)"}}, "id": 152, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "639:44:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 153, "nodeType": "EmitStatement", "src": "634:49:1"}]}, "documentation": {"id": 137, "nodeType": "StructuredDocumentation", "src": "500:77:1", "text": " @notice Initialize the contract with the deployer as owner"}, "id": 155, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nameLocation": "-1:-1:-1", "nodeType": "FunctionDefinition", "parameters": {"id": 138, "nodeType": "ParameterList", "parameters": [], "src": "593:2:1"}, "returnParameters": {"id": 139, "nodeType": "ParameterList", "parameters": [], "src": "596:0:1"}, "scope": 192, "src": "582:108:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 181, "nodeType": "Block", "src": "1020:189:1", "statements": [{"condition": {"commonType": {"typeIdentifier": "t_address", "typeString": "address"}, "id": 165, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"expression": {"id": 161, "name": "tx", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -26, "src": "1034:2:1", "typeDescriptions": {"typeIdentifier": "t_magic_transaction", "typeString": "tx"}}, "id": 162, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1037:6:1", "memberName": "origin", "nodeType": "MemberAccess", "src": "1034:9:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "BinaryOperation", "operator": "!=", "rightExpression": {"expression": {"id": 163, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1047:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 164, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1051:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "1047:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "src": "1034:23:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 180, "nodeType": "IfStatement", "src": "1030:173:1", "trueBody": {"id": 179, "nodeType": "Block", "src": "1059:144:1", "statements": [{"assignments": [167], "declarations": [{"constant": false, "id": 167, "mutability": "mutable", "name": "previousOwner", "nameLocation": "1081:13:1", "nodeType": "VariableDeclaration", "scope": 179, "src": "1073:21:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 166, "name": "address", "nodeType": "ElementaryTypeName", "src": "1073:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "id": 169, "initialValue": {"id": 168, "name": "owner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "1097:5:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "VariableDeclarationStatement", "src": "1073:29:1"}, {"expression": {"id": 172, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 170, "name": "owner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "1116:5:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"id": 171, "name": "_owner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 158, "src": "1124:6:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "src": "1116:14:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "id": 173, "nodeType": "ExpressionStatement", "src": "1116:14:1"}, {"eventCall": {"arguments": [{"id": 175, "name": "previousOwner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 167, "src": "1170:13:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, {"id": 176, "name": "_owner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 158, "src": "1185:6:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}, {"typeIdentifier": "t_address", "typeString": "address"}], "id": 174, "name": "OwnershipTransferred", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 136, "src": "1149:20:1", "typeDescriptions": {"typeIdentifier": "t_function_event_nonpayable$_t_address_$_t_address_$returns$__$", "typeString": "function (address,address)"}}, "id": 177, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1149:43:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 178, "nodeType": "EmitStatement", "src": "1144:48:1"}]}}]}, "documentation": {"id": 156, "nodeType": "StructuredDocumentation", "src": "696:275:1", "text": " @notice Change the owner of the contract\n @param _owner The new owner address\n @dev VULNERABILITY: Uses tx.origin instead of proper access control\n The condition tx.origin != msg.sender can be exploited by calling through another contract"}, "functionSelector": "a6f9dae1", "id": 182, "implemented": true, "kind": "function", "modifiers": [], "name": "changeOwner", "nameLocation": "985:11:1", "nodeType": "FunctionDefinition", "parameters": {"id": 159, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 158, "mutability": "mutable", "name": "_owner", "nameLocation": "1005:6:1", "nodeType": "VariableDeclaration", "scope": 182, "src": "997:14:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 157, "name": "address", "nodeType": "ElementaryTypeName", "src": "997:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "996:16:1"}, "returnParameters": {"id": 160, "nodeType": "ParameterList", "parameters": [], "src": "1020:0:1"}, "scope": 192, "src": "976:233:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 190, "nodeType": "Block", "src": "1353:29:1", "statements": [{"expression": {"id": 188, "name": "owner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 130, "src": "1370:5:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "functionReturnParameters": 187, "id": 189, "nodeType": "Return", "src": "1363:12:1"}]}, "documentation": {"id": 183, "nodeType": "StructuredDocumentation", "src": "1215:81:1", "text": " @notice Get the current owner\n @return The owner address"}, "functionSelector": "893d20e8", "id": 191, "implemented": true, "kind": "function", "modifiers": [], "name": "getOwner", "nameLocation": "1310:8:1", "nodeType": "FunctionDefinition", "parameters": {"id": 184, "nodeType": "ParameterList", "parameters": [], "src": "1318:2:1"}, "returnParameters": {"id": 187, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 186, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 191, "src": "1344:7:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 185, "name": "address", "nodeType": "ElementaryTypeName", "src": "1344:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}], "src": "1343:9:1"}, "scope": 192, "src": "1301:81:1", "stateMutability": "view", "virtual": false, "visibility": "external"}], "scope": 193, "src": "358:1026:1", "usedErrors": [], "usedEvents": [136]}], "src": "32:1352:1"}}}, "sourceList": ["/workspaces/evm-ctf-challenges/challenges/03-Telephone/echidna/TelephoneEchidna.sol", "/workspaces/evm-ctf-challenges/challenges/03-Telephone/src/Telephone.sol"], "contracts": {"/workspaces/evm-ctf-challenges/challenges/03-Telephone/echidna/TelephoneEchidna.sol:Helper": {"srcmap": "2121:448:0:-:0;;;2180:82;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;2244:10;2222:9;;:33;;;;;;;;;;;;;;;;;;2180:82;2121:448;;88:117:2;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:143::-;753:5;784:6;778:13;769:22;;800:33;827:5;800:33;:::i;:::-;696:143;;;;:::o;845:351::-;915:6;964:2;952:9;943:7;939:23;935:32;932:119;;;970:79;;:::i;:::-;932:119;1090:1;1115:64;1171:7;1162:6;1151:9;1147:22;1115:64;:::i;:::-;1105:74;;1061:128;845:351;;;;:::o;2121:448:0:-;;;;;;;", "srcmap-runtime": "2121:448:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2462:105;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;2143:26;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;2462:105;2529:9;;;;;;;;;;;:21;;;2551:8;2529:31;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2462:105;:::o;2143:26::-;;;;;;;;;;;;;:::o;88:117:2:-;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:139::-;742:5;780:6;767:20;758:29;;796:33;823:5;796:33;:::i;:::-;696:139;;;;:::o;841:329::-;900:6;949:2;937:9;928:7;924:23;920:32;917:119;;;955:79;;:::i;:::-;917:119;1075:1;1100:53;1145:7;1136:6;1125:9;1121:22;1100:53;:::i;:::-;1090:63;;1046:117;841:329;;;;:::o;1176:60::-;1204:3;1225:5;1218:12;;1176:60;;;:::o;1242:142::-;1292:9;1325:53;1343:34;1352:24;1370:5;1352:24;:::i;:::-;1343:34;:::i;:::-;1325:53;:::i;:::-;1312:66;;1242:142;;;:::o;1390:126::-;1440:9;1473:37;1504:5;1473:37;:::i;:::-;1460:50;;1390:126;;;:::o;1522:143::-;1589:9;1622:37;1653:5;1622:37;:::i;:::-;1609:50;;1522:143;;;:::o;1671:165::-;1775:54;1823:5;1775:54;:::i;:::-;1770:3;1763:67;1671:165;;:::o;1842:256::-;1952:4;1990:2;1979:9;1975:18;1967:26;;2003:88;2088:1;2077:9;2073:17;2064:6;2003:88;:::i;:::-;1842:256;;;;:::o;2104:118::-;2191:24;2209:5;2191:24;:::i;:::-;2186:3;2179:37;2104:118;;:::o;2228:222::-;2321:4;2359:2;2348:9;2344:18;2336:26;;2372:71;2440:1;2429:9;2425:17;2416:6;2372:71;:::i;:::-;2228:222;;;;:::o", "abi": "[{\"inputs\": [{\"internalType\": \"address\", \"name\": \"_telephone\", \"type\": \"address\"}], \"stateMutability\": \"nonpayable\", \"type\": \"constructor\"}, {\"inputs\": [{\"internalType\": \"address\", \"name\": \"newOwner\", \"type\": \"address\"}], \"name\": \"changeOwnerViaHelper\", \"outputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"telephone\", \"outputs\": [{\"internalType\": \"contract Telephone\", \"name\": \"\", \"type\": \"address\"}], \"stateMutability\": \"view\", \"type\": \"function\"}]", "bin": "608060405234801561000f575f5ffd5b50604051610386380380610386833981810160405281019061003191906100d4565b805f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550506100ff565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6100a38261007a565b9050919050565b6100b381610099565b81146100bd575f5ffd5b50565b5f815190506100ce816100aa565b92915050565b5f602082840312156100e9576100e8610076565b5b5f6100f6848285016100c0565b91505092915050565b61027a8061010c5f395ff3fe608060405234801561000f575f5ffd5b5060043610610034575f3560e01c806310a564dc1461003857806393acaa5914610054575b5f5ffd5b610052600480360381019061004d919061017d565b610072565b005b61005c6100fb565b6040516100699190610203565b60405180910390f35b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a6f9dae1826040518263ffffffff1660e01b81526004016100cb919061022b565b5f604051808303815f87803b1580156100e2575f5ffd5b505af11580156100f4573d5f5f3e3d5ffd5b5050505050565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61014c82610123565b9050919050565b61015c81610142565b8114610166575f5ffd5b50565b5f8135905061017781610153565b92915050565b5f602082840312156101925761019161011f565b5b5f61019f84828501610169565b91505092915050565b5f819050919050565b5f6101cb6101c66101c184610123565b6101a8565b610123565b9050919050565b5f6101dc826101b1565b9050919050565b5f6101ed826101d2565b9050919050565b6101fd816101e3565b82525050565b5f6020820190506102165f8301846101f4565b92915050565b61022581610142565b82525050565b5f60208201905061023e5f83018461021c565b9291505056fea2646970667358221220a34208a02acb53820791b98e6bc8fc989869d8306f3d9edab1c74cf89323d1e664736f6c634300081e0033", "bin-runtime": "608060405234801561000f575f5ffd5b5060043610610034575f3560e01c806310a564dc1461003857806393acaa5914610054575b5f5ffd5b610052600480360381019061004d919061017d565b610072565b005b61005c6100fb565b6040516100699190610203565b60405180910390f35b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a6f9dae1826040518263ffffffff1660e01b81526004016100cb919061022b565b5f604051808303815f87803b1580156100e2575f5ffd5b505af11580156100f4573d5f5f3e3d5ffd5b5050505050565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61014c82610123565b9050919050565b61015c81610142565b8114610166575f5ffd5b50565b5f8135905061017781610153565b92915050565b5f602082840312156101925761019161011f565b5b5f61019f84828501610169565b91505092915050565b5f819050919050565b5f6101cb6101c66101c184610123565b6101a8565b610123565b9050919050565b5f6101dc826101b1565b9050919050565b5f6101ed826101d2565b9050919050565b6101fd816101e3565b82525050565b5f6020820190506102165f8301846101f4565b92915050565b61022581610142565b82525050565b5f60208201905061023e5f83018461021c565b9291505056fea2646970667358221220a34208a02acb53820791b98e6bc8fc989869d8306f3d9edab1c74cf89323d1e664736f6c634300081e0033", "userdoc": {"methods": {"changeOwnerViaHelper(address)": {"notice": "Change owner through this helper contract"}}, "notice": "Helper contract to create tx.origin != msg.sender scenario"}, "devdoc": {"methods": {"changeOwnerViaHelper(address)": {"author": null, "details": "When called, tx.origin != msg.sender, so vulnerability triggers", "params": {"newOwner": "New owner address"}, "return": null}}, "author": null, "details": null, "title": "Helper"}, "libraries": {}}, "/workspaces/evm-ctf-challenges/challenges/03-Telephone/echidna/TelephoneEchidna.sol:TelephoneEchidna": {"srcmap": "295:1729:0:-:0;;;491:150;;;;;;;;;;527:15;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;515:9;;:27;;;;;;;;;;;;;;;;;;568:9;;;;;;;;;;;:15;;;:17;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;552:33;;;;;;;;;;623:9;;;;;;;;;;;604:30;;;;;:::i;:::-;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;595:6;;:39;;;;;;;;;;;;;;;;;;295:1729;;;;;;;;;;:::o;:::-;;;;;;;;:::o;88:117:2:-;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:143::-;753:5;784:6;778:13;769:22;;800:33;827:5;800:33;:::i;:::-;696:143;;;;:::o;845:351::-;915:6;964:2;952:9;943:7;939:23;935:32;932:119;;;970:79;;:::i;:::-;932:119;1090:1;1115:64;1171:7;1162:6;1151:9;1147:22;1115:64;:::i;:::-;1105:74;;1061:128;845:351;;;;:::o;1202:118::-;1289:24;1307:5;1289:24;:::i;:::-;1284:3;1277:37;1202:118;;:::o;1326:222::-;1419:4;1457:2;1446:9;1442:18;1434:26;;1470:71;1538:1;1527:9;1523:17;1514:6;1470:71;:::i;:::-;1326:222;;;;:::o;295:1729:0:-;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "295:1729:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1368:182;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;1782:240;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;460:20;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;327:26;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;359:38;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;815:120;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;1080:118;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;1368:182;1512:9;;;;;;;;;;;:21;;;1534:8;1512:31;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1368:182;:::o;1782:240::-;1978:6;;;;;;;;;;;:27;;;2006:8;1978:37;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1782:240;:::o;460:20::-;;;;;;;;;;;;;:::o;327:26::-;;;;;;;;;;;;;:::o;359:38::-;;;:::o;815:120::-;871:4;915:13;894:34;;:9;;;;;;;;;;;:15;;;:17;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:34;;;887:41;;815:120;:::o;1080:118::-;1137:4;1189:1;1160:31;;:9;;;;;;;;;;;:15;;;:17;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:31;;;;1153:38;;1080:118;:::o;88:117:2:-;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:139::-;742:5;780:6;767:20;758:29;;796:33;823:5;796:33;:::i;:::-;696:139;;;;:::o;841:329::-;900:6;949:2;937:9;928:7;924:23;920:32;917:119;;;955:79;;:::i;:::-;917:119;1075:1;1100:53;1145:7;1136:6;1125:9;1121:22;1100:53;:::i;:::-;1090:63;;1046:117;841:329;;;;:::o;1176:60::-;1204:3;1225:5;1218:12;;1176:60;;;:::o;1242:142::-;1292:9;1325:53;1343:34;1352:24;1370:5;1352:24;:::i;:::-;1343:34;:::i;:::-;1325:53;:::i;:::-;1312:66;;1242:142;;;:::o;1390:126::-;1440:9;1473:37;1504:5;1473:37;:::i;:::-;1460:50;;1390:126;;;:::o;1522:140::-;1586:9;1619:37;1650:5;1619:37;:::i;:::-;1606:50;;1522:140;;;:::o;1668:159::-;1769:51;1814:5;1769:51;:::i;:::-;1764:3;1757:64;1668:159;;:::o;1833:250::-;1940:4;1978:2;1967:9;1963:18;1955:26;;1991:85;2073:1;2062:9;2058:17;2049:6;1991:85;:::i;:::-;1833:250;;;;:::o;2089:143::-;2156:9;2189:37;2220:5;2189:37;:::i;:::-;2176:50;;2089:143;;;:::o;2238:165::-;2342:54;2390:5;2342:54;:::i;:::-;2337:3;2330:67;2238:165;;:::o;2409:256::-;2519:4;2557:2;2546:9;2542:18;2534:26;;2570:88;2655:1;2644:9;2640:17;2631:6;2570:88;:::i;:::-;2409:256;;;;:::o;2671:118::-;2758:24;2776:5;2758:24;:::i;:::-;2753:3;2746:37;2671:118;;:::o;2795:222::-;2888:4;2926:2;2915:9;2911:18;2903:26;;2939:71;3007:1;2996:9;2992:17;2983:6;2939:71;:::i;:::-;2795:222;;;;:::o;3023:90::-;3057:7;3100:5;3093:13;3086:21;3075:32;;3023:90;;;:::o;3119:109::-;3200:21;3215:5;3200:21;:::i;:::-;3195:3;3188:34;3119:109;;:::o;3234:210::-;3321:4;3359:2;3348:9;3344:18;3336:26;;3372:65;3434:1;3423:9;3419:17;3410:6;3372:65;:::i;:::-;3234:210;;;;:::o;3450:143::-;3507:5;3538:6;3532:13;3523:22;;3554:33;3581:5;3554:33;:::i;:::-;3450:143;;;;:::o;3599:351::-;3669:6;3718:2;3706:9;3697:7;3693:23;3689:32;3686:119;;;3724:79;;:::i;:::-;3686:119;3844:1;3869:64;3925:7;3916:6;3905:9;3901:22;3869:64;:::i;:::-;3859:74;;3815:128;3599:351;;;;:::o", "abi": "[{\"inputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"constructor\"}, {\"inputs\": [], \"name\": \"INITIAL_OWNER\", \"outputs\": [{\"internalType\": \"address\", \"name\": \"\", \"type\": \"address\"}], \"stateMutability\": \"view\", \"type\": \"function\"}, {\"inputs\": [{\"internalType\": \"address\", \"name\": \"newOwner\", \"type\": \"address\"}], \"name\": \"callChangeOwnerDirectly\", \"outputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"function\"}, {\"inputs\": [{\"internalType\": \"address\", \"name\": \"newOwner\", \"type\": \"address\"}], \"name\": \"callChangeOwnerThroughHelper\", \"outputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"echidna_owner_never_zero\", \"outputs\": [{\"internalType\": \"bool\", \"name\": \"\", \"type\": \"bool\"}], \"stateMutability\": \"view\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"echidna_owner_unchanged\", \"outputs\": [{\"internalType\": \"bool\", \"name\": \"\", \"type\": \"bool\"}], \"stateMutability\": \"view\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"helper\", \"outputs\": [{\"internalType\": \"contract Helper\", \"name\": \"\", \"type\": \"address\"}], \"stateMutability\": \"view\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"telephone\", \"outputs\": [{\"internalType\": \"contract Telephone\", \"name\": \"\", \"type\": \"address\"}], \"stateMutability\": \"view\", \"type\": \"function\"}]", "bin": "60a060405234801561000f575f5ffd5b5060405161001c906101c9565b604051809103905ff080158015610035573d5f5f3e3d5ffd5b505f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156100dd573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101019190610241565b73ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff16815250505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051610161906101d6565b61016b919061027b565b604051809103905ff080158015610184573d5f5f3e3d5ffd5b5060015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550610294565b6103778061092983390190565b61038680610ca083390190565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610210826101e7565b9050919050565b61022081610206565b811461022a575f5ffd5b50565b5f8151905061023b81610217565b92915050565b5f60208284031215610256576102556101e3565b5b5f6102638482850161022d565b91505092915050565b61027581610206565b82525050565b5f60208201905061028e5f83018461026c565b92915050565b6080516106766102b35f395f81816102ab01526102d001526106765ff3fe608060405234801561000f575f5ffd5b506004361061007b575f3560e01c806393acaa591161005957806393acaa59146100d5578063a36250d8146100f3578063e8798d7e14610111578063f4540b871461012f5761007b565b80631b44fe551461007f5780634eb4c4741461009b57806363b0e66a146100b7575b5f5ffd5b610099600480360381019061009491906104ce565b61014d565b005b6100b560048036038101906100b091906104ce565b6101d6565b005b6100bf610260565b6040516100cc9190610554565b60405180910390f35b6100dd610285565b6040516100ea919061058d565b60405180910390f35b6100fb6102a9565b60405161010891906105b5565b60405180910390f35b6101196102cd565b60405161012691906105e8565b60405180910390f35b6101376103ae565b60405161014491906105e8565b60405180910390f35b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a6f9dae1826040518263ffffffff1660e01b81526004016101a691906105b5565b5f604051808303815f87803b1580156101bd575f5ffd5b505af11580156101cf573d5f5f3e3d5ffd5b5050505050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166310a564dc826040518263ffffffff1660e01b815260040161023091906105b5565b5f604051808303815f87803b158015610247575f5ffd5b505af1158015610259573d5f5f3e3d5ffd5b5050505050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b7f000000000000000000000000000000000000000000000000000000000000000081565b5f7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff165f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561036e573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103929190610615565b73ffffffffffffffffffffffffffffffffffffffff1614905090565b5f5f73ffffffffffffffffffffffffffffffffffffffff165f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561042f573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104539190610615565b73ffffffffffffffffffffffffffffffffffffffff161415905090565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61049d82610474565b9050919050565b6104ad81610493565b81146104b7575f5ffd5b50565b5f813590506104c8816104a4565b92915050565b5f602082840312156104e3576104e2610470565b5b5f6104f0848285016104ba565b91505092915050565b5f819050919050565b5f61051c61051761051284610474565b6104f9565b610474565b9050919050565b5f61052d82610502565b9050919050565b5f61053e82610523565b9050919050565b61054e81610534565b82525050565b5f6020820190506105675f830184610545565b92915050565b5f61057782610523565b9050919050565b6105878161056d565b82525050565b5f6020820190506105a05f83018461057e565b92915050565b6105af81610493565b82525050565b5f6020820190506105c85f8301846105a6565b92915050565b5f8115159050919050565b6105e2816105ce565b82525050565b5f6020820190506105fb5f8301846105d9565b92915050565b5f8151905061060f816104a4565b92915050565b5f6020828403121561062a57610629610470565b5b5f61063784828501610601565b9150509291505056fea26469706673582212202fc29153d7454f032eccf6f4cbe68ea70968439bcda781d7069b3c167e68375064736f6c634300081e00336080604052348015600e575f5ffd5b50335f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055503373ffffffffffffffffffffffffffffffffffffffff165f73ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a36102c2806100b55f395ff3fe608060405234801561000f575f5ffd5b506004361061003f575f3560e01c8063893d20e8146100435780638da5cb5b14610061578063a6f9dae11461007f575b5f5ffd5b61004b61009b565b604051610058919061021a565b60405180910390f35b6100696100c2565b604051610076919061021a565b60405180910390f35b61009960048036038101906100949190610261565b6100e6565b005b5f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b3373ffffffffffffffffffffffffffffffffffffffff163273ffffffffffffffffffffffffffffffffffffffff16146101d8575f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050815f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3505b50565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610204826101db565b9050919050565b610214816101fa565b82525050565b5f60208201905061022d5f83018461020b565b92915050565b5f5ffd5b610240816101fa565b811461024a575f5ffd5b50565b5f8135905061025b81610237565b92915050565b5f6020828403121561027657610275610233565b5b5f6102838482850161024d565b9150509291505056fea26469706673582212205303893bb190f8a4c8b43b70ab346c936cc7ca0007b1b89f714455f578fc064264736f6c634300081e0033608060405234801561000f575f5ffd5b50604051610386380380610386833981810160405281019061003191906100d4565b805f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550506100ff565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6100a38261007a565b9050919050565b6100b381610099565b81146100bd575f5ffd5b50565b5f815190506100ce816100aa565b92915050565b5f602082840312156100e9576100e8610076565b5b5f6100f6848285016100c0565b91505092915050565b61027a8061010c5f395ff3fe608060405234801561000f575f5ffd5b5060043610610034575f3560e01c806310a564dc1461003857806393acaa5914610054575b5f5ffd5b610052600480360381019061004d919061017d565b610072565b005b61005c6100fb565b6040516100699190610203565b60405180910390f35b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a6f9dae1826040518263ffffffff1660e01b81526004016100cb919061022b565b5f604051808303815f87803b1580156100e2575f5ffd5b505af11580156100f4573d5f5f3e3d5ffd5b5050505050565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61014c82610123565b9050919050565b61015c81610142565b8114610166575f5ffd5b50565b5f8135905061017781610153565b92915050565b5f602082840312156101925761019161011f565b5b5f61019f84828501610169565b91505092915050565b5f819050919050565b5f6101cb6101c66101c184610123565b6101a8565b610123565b9050919050565b5f6101dc826101b1565b9050919050565b5f6101ed826101d2565b9050919050565b6101fd816101e3565b82525050565b5f6020820190506102165f8301846101f4565b92915050565b61022581610142565b82525050565b5f60208201905061023e5f83018461021c565b9291505056fea2646970667358221220a34208a02acb53820791b98e6bc8fc989869d8306f3d9edab1c74cf89323d1e664736f6c634300081e0033", "bin-runtime": "608060405234801561000f575f5ffd5b506004361061007b575f3560e01c806393acaa591161005957806393acaa59146100d5578063a36250d8146100f3578063e8798d7e14610111578063f4540b871461012f5761007b565b80631b44fe551461007f5780634eb4c4741461009b57806363b0e66a146100b7575b5f5ffd5b610099600480360381019061009491906104ce565b61014d565b005b6100b560048036038101906100b091906104ce565b6101d6565b005b6100bf610260565b6040516100cc9190610554565b60405180910390f35b6100dd610285565b6040516100ea919061058d565b60405180910390f35b6100fb6102a9565b60405161010891906105b5565b60405180910390f35b6101196102cd565b60405161012691906105e8565b60405180910390f35b6101376103ae565b60405161014491906105e8565b60405180910390f35b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a6f9dae1826040518263ffffffff1660e01b81526004016101a691906105b5565b5f604051808303815f87803b1580156101bd575f5ffd5b505af11580156101cf573d5f5f3e3d5ffd5b5050505050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166310a564dc826040518263ffffffff1660e01b815260040161023091906105b5565b5f604051808303815f87803b158015610247575f5ffd5b505af1158015610259573d5f5f3e3d5ffd5b5050505050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b7f000000000000000000000000000000000000000000000000000000000000000081565b5f7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff165f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561036e573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103929190610615565b73ffffffffffffffffffffffffffffffffffffffff1614905090565b5f5f73ffffffffffffffffffffffffffffffffffffffff165f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561042f573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104539190610615565b73ffffffffffffffffffffffffffffffffffffffff161415905090565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61049d82610474565b9050919050565b6104ad81610493565b81146104b7575f5ffd5b50565b5f813590506104c8816104a4565b92915050565b5f602082840312156104e3576104e2610470565b5b5f6104f0848285016104ba565b91505092915050565b5f819050919050565b5f61051c61051761051284610474565b6104f9565b610474565b9050919050565b5f61052d82610502565b9050919050565b5f61053e82610523565b9050919050565b61054e81610534565b82525050565b5f6020820190506105675f830184610545565b92915050565b5f61057782610523565b9050919050565b6105878161056d565b82525050565b5f6020820190506105a05f83018461057e565b92915050565b6105af81610493565b82525050565b5f6020820190506105c85f8301846105a6565b92915050565b5f8115159050919050565b6105e2816105ce565b82525050565b5f6020820190506105fb5f8301846105d9565b92915050565b5f8151905061060f816104a4565b92915050565b5f6020828403121561062a57610629610470565b5b5f61063784828501610601565b9150509291505056fea26469706673582212202fc29153d7454f032eccf6f4cbe68ea70968439bcda781d7069b3c167e68375064736f6c634300081e0033", "userdoc": {"methods": {"callChangeOwnerDirectly(address)": {"notice": "Direct call to change owner (will fail due to tx.origin == msg.sender)"}, "callChangeOwnerThroughHelper(address)": {"notice": "Call through helper contract (can succeed due to tx.origin != msg.sender)  "}, "echidna_owner_never_zero()": {"notice": "Property: Owner is never zero address"}, "echidna_owner_unchanged()": {"notice": "Property: Owner should never change (this WILL be violated)"}}, "notice": "Property-based testing for Telephone contract using Echidna"}, "devdoc": {"methods": {"callChangeOwnerDirectly(address)": {"author": null, "details": null, "params": {"newOwner": "Address to attempt to set as owner"}, "return": null}, "callChangeOwnerThroughHelper(address)": {"author": null, "details": "This creates the vulnerability: tx.origin != msg.sender", "params": {"newOwner": "Address to set as owner"}, "return": null}, "echidna_owner_never_zero()": {"author": null, "details": "Should generally pass unless specifically set to zero", "params": {}, "return": null}, "echidna_owner_unchanged()": {"author": null, "details": "This property will FAIL when Echidna finds the vulnerability", "params": {}, "return": null}}, "author": null, "details": "This demonstrates that Echidna CAN find tx.origin vulnerabilities when properly configured", "title": "TelephoneEchidna"}, "libraries": {}}, "/workspaces/evm-ctf-challenges/challenges/03-Telephone/src/Telephone.sol:Telephone": {"srcmap": "358:1026:1:-:0;;;582:108;;;;;;;;;;614:10;606:5;;:18;;;;;;;;;;;;;;;;;;672:10;639:44;;668:1;639:44;;;;;;;;;;;;358:1026;;;;;;", "srcmap-runtime": "358:1026:1:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1301:81;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;383:20;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;976:233;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;1301:81;1344:7;1370:5;;;;;;;;;;;1363:12;;1301:81;:::o;383:20::-;;;;;;;;;;;;;:::o;976:233::-;1047:10;1034:23;;:9;:23;;;1030:173;;1073:21;1097:5;;;;;;;;;;;1073:29;;1124:6;1116:5;;:14;;;;;;;;;;;;;;;;;;1185:6;1149:43;;1170:13;1149:43;;;;;;;;;;;;1059:144;1030:173;976:233;:::o;7:126:2:-;44:7;84:42;77:5;73:54;62:65;;7:126;;;:::o;139:96::-;176:7;205:24;223:5;205:24;:::i;:::-;194:35;;139:96;;;:::o;241:118::-;328:24;346:5;328:24;:::i;:::-;323:3;316:37;241:118;;:::o;365:222::-;458:4;496:2;485:9;481:18;473:26;;509:71;577:1;566:9;562:17;553:6;509:71;:::i;:::-;365:222;;;;:::o;674:117::-;783:1;780;773:12;920:122;993:24;1011:5;993:24;:::i;:::-;986:5;983:35;973:63;;1032:1;1029;1022:12;973:63;920:122;:::o;1048:139::-;1094:5;1132:6;1119:20;1110:29;;1148:33;1175:5;1148:33;:::i;:::-;1048:139;;;;:::o;1193:329::-;1252:6;1301:2;1289:9;1280:7;1276:23;1272:32;1269:119;;;1307:79;;:::i;:::-;1269:119;1427:1;1452:53;1497:7;1488:6;1477:9;1473:22;1452:53;:::i;:::-;1442:63;;1398:117;1193:329;;;;:::o", "abi": "[{\"inputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"constructor\"}, {\"anonymous\": false, \"inputs\": [{\"indexed\": true, \"internalType\": \"address\", \"name\": \"previousOwner\", \"type\": \"address\"}, {\"indexed\": true, \"internalType\": \"address\", \"name\": \"newOwner\", \"type\": \"address\"}], \"name\": \"OwnershipTransferred\", \"type\": \"event\"}, {\"inputs\": [{\"internalType\": \"address\", \"name\": \"_owner\", \"type\": \"address\"}], \"name\": \"changeOwner\", \"outputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"getOwner\", \"outputs\": [{\"internalType\": \"address\", \"name\": \"\", \"type\": \"address\"}], \"stateMutability\": \"view\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"owner\", \"outputs\": [{\"internalType\": \"address\", \"name\": \"\", \"type\": \"address\"}], \"stateMutability\": \"view\", \"type\": \"function\"}]", "bin": "6080604052348015600e575f5ffd5b50335f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055503373ffffffffffffffffffffffffffffffffffffffff165f73ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a36102c2806100b55f395ff3fe608060405234801561000f575f5ffd5b506004361061003f575f3560e01c8063893d20e8146100435780638da5cb5b14610061578063a6f9dae11461007f575b5f5ffd5b61004b61009b565b604051610058919061021a565b60405180910390f35b6100696100c2565b604051610076919061021a565b60405180910390f35b61009960048036038101906100949190610261565b6100e6565b005b5f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b3373ffffffffffffffffffffffffffffffffffffffff163273ffffffffffffffffffffffffffffffffffffffff16146101d8575f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050815f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3505b50565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610204826101db565b9050919050565b610214816101fa565b82525050565b5f60208201905061022d5f83018461020b565b92915050565b5f5ffd5b610240816101fa565b811461024a575f5ffd5b50565b5f8135905061025b81610237565b92915050565b5f6020828403121561027657610275610233565b5b5f6102838482850161024d565b9150509291505056fea26469706673582212205303893bb190f8a4c8b43b70ab346c936cc7ca0007b1b89f714455f578fc064264736f6c634300081e0033", "bin-runtime": "608060405234801561000f575f5ffd5b506004361061003f575f3560e01c8063893d20e8146100435780638da5cb5b14610061578063a6f9dae11461007f575b5f5ffd5b61004b61009b565b604051610058919061021a565b60405180910390f35b6100696100c2565b604051610076919061021a565b60405180910390f35b61009960048036038101906100949190610261565b6100e6565b005b5f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b3373ffffffffffffffffffffffffffffffffffffffff163273ffffffffffffffffffffffffffffffffffffffff16146101d8575f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050815f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3505b50565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610204826101db565b9050919050565b610214816101fa565b82525050565b5f60208201905061022d5f83018461020b565b92915050565b5f5ffd5b610240816101fa565b811461024a575f5ffd5b50565b5f8135905061025b81610237565b92915050565b5f6020828403121561027657610275610233565b5b5f6102838482850161024d565b9150509291505056fea26469706673582212205303893bb190f8a4c8b43b70ab346c936cc7ca0007b1b89f714455f578fc064264736f6c634300081e0033", "userdoc": {"methods": {"changeOwner(address)": {"notice": "Change the owner of the contract"}, "constructor": {"notice": "Initialize the contract with the deployer as owner"}, "getOwner()": {"notice": "Get the current owner"}}, "notice": "A vulnerable contract that demonstrates tx.origin vs msg.sender confusion"}, "devdoc": {"methods": {"changeOwner(address)": {"author": null, "details": "VULNERABILITY: Uses tx.origin instead of proper access control The condition tx.origin != msg.sender can be exploited by calling through another contract", "params": {"_owner": "The new owner address"}, "return": null}, "getOwner()": {"author": null, "details": null, "params": {}, "return": null}}, "author": null, "details": "The vulnerability lies in the changeOwner function which checks tx.origin != msg.sender This allows an attacker to change ownership by calling through an intermediary contract", "title": "Telephone"}, "libraries": {}}}}