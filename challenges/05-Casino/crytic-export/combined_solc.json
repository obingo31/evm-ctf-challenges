{"sources": {"/workspaces/evm-ctf-challenges/challenges/05-Casino/echidna/CasinoEchidna.sol": {"AST": {"absolutePath": "echidna/CasinoEchidna.sol", "exportedSymbols": {"Casino": [236], "CasinoEchidna": [59]}, "id": 60, "license": "MIT", "nodeType": "SourceUnit", "nodes": [{"id": 1, "literals": ["solidity", "^", "0.8", ".18"], "nodeType": "PragmaDirective", "src": "32:24:0"}, {"absolutePath": "src/Casino.sol", "file": "../src/Casino.sol", "id": 2, "nameLocation": "-1:-1:-1", "nodeType": "ImportDirective", "scope": 60, "sourceUnit": 237, "src": "58:27:0", "symbolAliases": [], "unitAlias": ""}, {"abstract": false, "baseContracts": [], "canonicalName": "CasinoEchidna", "contractDependencies": [236], "contractKind": "contract", "documentation": {"id": 3, "nodeType": "StructuredDocumentation", "src": "87:101:0", "text": " @title CasinoEchidna\n @notice Echidna harness that encodes the intended safety invariant"}, "fullyImplemented": true, "id": 59, "linearizedBaseContracts": [59], "name": "CasinoEchidna", "nameLocation": "198:13:0", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 6, "mutability": "immutable", "name": "casino", "nameLocation": "244:6:0", "nodeType": "VariableDeclaration", "scope": 59, "src": "218:32:0", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}, "typeName": {"id": 5, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 4, "name": "Casino", "nameLocations": ["218:6:0"], "nodeType": "IdentifierPath", "referencedDeclaration": 236, "src": "218:6:0"}, "referencedDeclaration": 236, "src": "218:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "visibility": "internal"}, {"body": {"id": 16, "nodeType": "Block", "src": "271:38:0", "statements": [{"expression": {"id": 14, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9, "name": "casino", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "281:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [], "expression": {"argumentTypes": [], "id": 12, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "NewExpression", "src": "290:10:0", "typeDescriptions": {"typeIdentifier": "t_function_creation_nonpayable$__$returns$_t_contract$_Casino_$236_$", "typeString": "function () returns (contract Casino)"}, "typeName": {"id": 11, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10, "name": "Casino", "nameLocations": ["294:6:0"], "nodeType": "IdentifierPath", "referencedDeclaration": 236, "src": "294:6:0"}, "referencedDeclaration": 236, "src": "294:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}}, "id": 13, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "290:12:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "src": "281:21:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "id": 15, "nodeType": "ExpressionStatement", "src": "281:21:0"}]}, "id": 17, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nameLocation": "-1:-1:-1", "nodeType": "FunctionDefinition", "parameters": {"id": 7, "nodeType": "ParameterList", "parameters": [], "src": "268:2:0"}, "returnParameters": {"id": 8, "nodeType": "ParameterList", "parameters": [], "src": "271:0:0"}, "scope": 59, "src": "257:52:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 57, "nodeType": "Block", "src": "721:232:0", "statements": [{"assignments": [24], "declarations": [{"constant": false, "id": 24, "mutability": "mutable", "name": "guess", "nameLocation": "739:5:0", "nodeType": "VariableDeclaration", "scope": 57, "src": "731:13:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 23, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "731:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 28, "initialValue": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 25, "name": "casino", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "747:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "id": 26, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "754:16:0", "memberName": "getCurrentNumber", "nodeType": "MemberAccess", "referencedDeclaration": 235, "src": "747:23:0", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_uint256_$", "typeString": "function () view external returns (uint256)"}}, "id": 27, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "747:25:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "731:41:0"}, {"expression": {"arguments": [{"id": 32, "name": "guess", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 24, "src": "793:5:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"id": 29, "name": "casino", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "782:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "id": 31, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "789:3:0", "memberName": "bet", "nodeType": "MemberAccess", "referencedDeclaration": 164, "src": "782:10:0", "typeDescriptions": {"typeIdentifier": "t_function_external_nonpayable$_t_uint256_$returns$__$", "typeString": "function (uint256) external"}}, "id": 33, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "782:17:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 34, "nodeType": "ExpressionStatement", "src": "782:17:0"}, {"assignments": [36], "declarations": [{"constant": false, "id": 36, "mutability": "mutable", "name": "nextGuess", "nameLocation": "818:9:0", "nodeType": "VariableDeclaration", "scope": 57, "src": "810:17:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 35, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "810:7:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 40, "initialValue": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 37, "name": "casino", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "830:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "id": 38, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "837:16:0", "memberName": "getCurrentNumber", "nodeType": "MemberAccess", "referencedDeclaration": 235, "src": "830:23:0", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_uint256_$", "typeString": "function () view external returns (uint256)"}}, "id": 39, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "830:25:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "810:45:0"}, {"expression": {"arguments": [{"id": 44, "name": "nextGuess", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 36, "src": "876:9:0", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"id": 41, "name": "casino", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "865:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "id": 43, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "872:3:0", "memberName": "bet", "nodeType": "MemberAccess", "referencedDeclaration": 164, "src": "865:10:0", "typeDescriptions": {"typeIdentifier": "t_function_external_nonpayable$_t_uint256_$returns$__$", "typeString": "function (uint256) external"}}, "id": 45, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "865:21:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 46, "nodeType": "ExpressionStatement", "src": "865:21:0"}, {"expression": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 55, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"arguments": [{"arguments": [{"id": 51, "name": "this", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -28, "src": "935:4:0", "typeDescriptions": {"typeIdentifier": "t_contract$_CasinoEchidna_$59", "typeString": "contract CasinoEchidna"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_contract$_CasinoEchidna_$59", "typeString": "contract CasinoEchidna"}], "id": 50, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "927:7:0", "typeDescriptions": {"typeIdentifier": "t_type$_t_address_$", "typeString": "type(address)"}, "typeName": {"id": 49, "name": "address", "nodeType": "ElementaryTypeName", "src": "927:7:0", "typeDescriptions": {}}}, "id": 52, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "927:13:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}], "expression": {"id": 47, "name": "casino", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 6, "src": "904:6:0", "typeDescriptions": {"typeIdentifier": "t_contract$_Casino_$236", "typeString": "contract Casino"}}, "id": 48, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "911:15:0", "memberName": "consecutiveWins", "nodeType": "MemberAccess", "referencedDeclaration": 68, "src": "904:22:0", "typeDescriptions": {"typeIdentifier": "t_function_external_view$_t_address_$returns$_t_uint256_$", "typeString": "function (address) view external returns (uint256)"}}, "id": 53, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "904:37:0", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": {"hexValue": "31", "id": 54, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "945:1:0", "typeDescriptions": {"typeIdentifier": "t_rational_1_by_1", "typeString": "int_const 1"}, "value": "1"}, "src": "904:42:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "functionReturnParameters": 22, "id": 56, "nodeType": "Return", "src": "897:49:0"}]}, "documentation": {"id": 18, "nodeType": "StructuredDocumentation", "src": "315:346:0", "text": " @notice Invariant: a player should never exceed one consecutive win\n @dev Each call places exactly one bet using the publicly exposed RNG value.\n      Echidna repeats calls, so on the second invocation consecutiveWins becomes 2\n      and the property fails, demonstrating the bug without bespoke helper flows."}, "functionSelector": "25c998d0", "id": 58, "implemented": true, "kind": "function", "modifiers": [], "name": "echidna_no_double_win", "nameLocation": "675:21:0", "nodeType": "FunctionDefinition", "parameters": {"id": 19, "nodeType": "ParameterList", "parameters": [], "src": "696:2:0"}, "returnParameters": {"id": 22, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 21, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 58, "src": "715:4:0", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 20, "name": "bool", "nodeType": "ElementaryTypeName", "src": "715:4:0", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}], "src": "714:6:0"}, "scope": 59, "src": "666:287:0", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}], "scope": 60, "src": "189:766:0", "usedErrors": [], "usedEvents": []}], "src": "32:924:0"}}, "/workspaces/evm-ctf-challenges/challenges/05-Casino/src/Casino.sol": {"AST": {"absolutePath": "src/Casino.sol", "exportedSymbols": {"Casino": [236]}, "id": 237, "license": "MIT", "nodeType": "SourceUnit", "nodes": [{"id": 61, "literals": ["solidity", "^", "0.8", ".18"], "nodeType": "PragmaDirective", "src": "32:24:1"}, {"abstract": false, "baseContracts": [], "canonicalName": "Casino", "contractDependencies": [], "contractKind": "contract", "documentation": {"id": 62, "nodeType": "StructuredDocumentation", "src": "58:161:1", "text": " @title Casino\n @notice Vulnerable casino contract with predictable randomness\n @dev DO NOT USE IN PRODUCTION - Contains critical RNG vulnerability"}, "fullyImplemented": true, "id": 236, "linearizedBaseContracts": [236], "name": "Casino", "nameLocation": "229:6:1", "nodeType": "ContractDefinition", "nodes": [{"constant": false, "id": 64, "mutability": "mutable", "name": "seed", "nameLocation": "258:4:1", "nodeType": "VariableDeclaration", "scope": 236, "src": "242:20:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}, "typeName": {"id": 63, "name": "bytes32", "nodeType": "ElementaryTypeName", "src": "242:7:1", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}, "visibility": "private"}, {"constant": false, "functionSelector": "143af907", "id": 68, "mutability": "mutable", "name": "consecutiveWins", "nameLocation": "303:15:1", "nodeType": "VariableDeclaration", "scope": 236, "src": "268:50:1", "stateVariable": true, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "typeName": {"id": 67, "keyName": "", "keyNameLocation": "-1:-1:-1", "keyType": {"id": 65, "name": "address", "nodeType": "ElementaryTypeName", "src": "276:7:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "nodeType": "Mapping", "src": "268:27:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}, "valueName": "", "valueNameLocation": "-1:-1:-1", "valueType": {"id": 66, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "287:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}}, "visibility": "public"}, {"anonymous": false, "eventSelector": "eecad545a2ea4b549fd96ca809f2218e8daec7f3214b4813f4cddbc406ea803e", "id": 78, "name": "BetPlaced", "nameLocation": "331:9:1", "nodeType": "EventDefinition", "parameters": {"id": 77, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 70, "indexed": true, "mutability": "mutable", "name": "player", "nameLocation": "357:6:1", "nodeType": "VariableDeclaration", "scope": 78, "src": "341:22:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 69, "name": "address", "nodeType": "ElementaryTypeName", "src": "341:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}, {"constant": false, "id": 72, "indexed": false, "mutability": "mutable", "name": "guess", "nameLocation": "373:5:1", "nodeType": "VariableDeclaration", "scope": 78, "src": "365:13:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 71, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "365:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 74, "indexed": false, "mutability": "mutable", "name": "result", "nameLocation": "388:6:1", "nodeType": "VariableDeclaration", "scope": 78, "src": "380:14:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 73, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "380:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 76, "indexed": false, "mutability": "mutable", "name": "won", "nameLocation": "401:3:1", "nodeType": "VariableDeclaration", "scope": 78, "src": "396:8:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 75, "name": "bool", "nodeType": "ElementaryTypeName", "src": "396:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}], "src": "340:65:1"}, "src": "325:81:1"}, {"anonymous": false, "eventSelector": "483411878b50197a889f082127b6949d36484c69160aa7f00ec428c9cee13f17", "id": 84, "name": "ConsecutiveWinsUpdated", "nameLocation": "417:22:1", "nodeType": "EventDefinition", "parameters": {"id": 83, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 80, "indexed": true, "mutability": "mutable", "name": "player", "nameLocation": "456:6:1", "nodeType": "VariableDeclaration", "scope": 84, "src": "440:22:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}, "typeName": {"id": 79, "name": "address", "nodeType": "ElementaryTypeName", "src": "440:7:1", "stateMutability": "nonpayable", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "visibility": "internal"}, {"constant": false, "id": 82, "indexed": false, "mutability": "mutable", "name": "wins", "nameLocation": "472:4:1", "nodeType": "VariableDeclaration", "scope": 84, "src": "464:12:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 81, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "464:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "439:38:1"}, "src": "411:67:1"}, {"body": {"id": 93, "nodeType": "Block", "src": "498:52:1", "statements": [{"expression": {"id": 91, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 87, "name": "seed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 64, "src": "508:4:1", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"hexValue": "7361746f736869206e616b6d6f746f", "id": 89, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "525:17:1", "typeDescriptions": {"typeIdentifier": "t_stringliteral_b37c910f4e0df0efafb35a55489604369808b6de642ff1dbab5062680afaddcd", "typeString": "literal_string \"satoshi nakmoto\""}, "value": "satoshi nakmoto"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_stringliteral_b37c910f4e0df0efafb35a55489604369808b6de642ff1dbab5062680afaddcd", "typeString": "literal_string \"satoshi nakmoto\""}], "id": 88, "name": "keccak256", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -8, "src": "515:9:1", "typeDescriptions": {"typeIdentifier": "t_function_keccak256_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$", "typeString": "function (bytes memory) pure returns (bytes32)"}}, "id": 90, "isConstant": false, "isLValue": false, "isPure": true, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "515:28:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}, "src": "508:35:1", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}, "id": 92, "nodeType": "ExpressionStatement", "src": "508:35:1"}]}, "id": 94, "implemented": true, "kind": "constructor", "modifiers": [], "name": "", "nameLocation": "-1:-1:-1", "nodeType": "FunctionDefinition", "parameters": {"id": 85, "nodeType": "ParameterList", "parameters": [], "src": "495:2:1"}, "returnParameters": {"id": 86, "nodeType": "ParameterList", "parameters": [], "src": "498:0:1"}, "scope": 236, "src": "484:66:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 163, "nodeType": "Block", "src": "989:466:1", "statements": [{"assignments": [101], "declarations": [{"constant": false, "id": 101, "mutability": "mutable", "name": "num", "nameLocation": "1043:3:1", "nodeType": "VariableDeclaration", "scope": 163, "src": "1035:11:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 100, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1035:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 115, "initialValue": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 114, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"arguments": [{"arguments": [{"arguments": [{"id": 107, "name": "seed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 64, "src": "1084:4:1", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}, {"expression": {"id": 108, "name": "block", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -4, "src": "1090:5:1", "typeDescriptions": {"typeIdentifier": "t_magic_block", "typeString": "block"}}, "id": 109, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1096:6:1", "memberName": "number", "nodeType": "MemberAccess", "src": "1090:12:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bytes32", "typeString": "bytes32"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"id": 105, "name": "abi", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -1, "src": "1067:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_abi", "typeString": "abi"}}, "id": 106, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "1071:12:1", "memberName": "encodePacked", "nodeType": "MemberAccess", "src": "1067:16:1", "typeDescriptions": {"typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$", "typeString": "function () pure returns (bytes memory)"}}, "id": 110, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1067:36:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_bytes_memory_ptr", "typeString": "bytes memory"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bytes_memory_ptr", "typeString": "bytes memory"}], "id": 104, "name": "keccak256", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -8, "src": "1057:9:1", "typeDescriptions": {"typeIdentifier": "t_function_keccak256_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$", "typeString": "function (bytes memory) pure returns (bytes32)"}}, "id": 111, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1057:47:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bytes32", "typeString": "bytes32"}], "id": 103, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "1049:7:1", "typeDescriptions": {"typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)"}, "typeName": {"id": 102, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1049:7:1", "typeDescriptions": {}}}, "id": 112, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1049:56:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "^", "rightExpression": {"hexValue": "3078353339", "id": 113, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1108:5:1", "typeDescriptions": {"typeIdentifier": "t_rational_1337_by_1", "typeString": "int_const 1337"}, "value": "0x539"}, "src": "1049:64:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "1035:78:1"}, {"assignments": [117], "declarations": [{"constant": false, "id": 117, "mutability": "mutable", "name": "won", "nameLocation": "1129:3:1", "nodeType": "VariableDeclaration", "scope": 163, "src": "1124:8:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 116, "name": "bool", "nodeType": "ElementaryTypeName", "src": "1124:4:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}], "id": 122, "initialValue": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 120, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 118, "name": "guess", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 97, "src": "1136:5:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": {"id": 119, "name": "num", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 101, "src": "1145:3:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1136:12:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "id": 121, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "1135:14:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "nodeType": "VariableDeclarationStatement", "src": "1124:25:1"}, {"condition": {"id": 123, "name": "won", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 117, "src": "1164:3:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "falseBody": {"id": 144, "nodeType": "Block", "src": "1261:56:1", "statements": [{"expression": {"id": 142, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 137, "name": "consecutiveWins", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 68, "src": "1275:15:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 140, "indexExpression": {"expression": {"id": 138, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1291:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 139, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1295:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "1291:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1275:27:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "30", "id": 141, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1305:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "1275:31:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 143, "nodeType": "ExpressionStatement", "src": "1275:31:1"}]}, "id": 145, "nodeType": "IfStatement", "src": "1160:157:1", "trueBody": {"id": 136, "nodeType": "Block", "src": "1169:86:1", "statements": [{"expression": {"id": 134, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 124, "name": "consecutiveWins", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 68, "src": "1183:15:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 127, "indexExpression": {"expression": {"id": 125, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1199:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 126, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1203:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "1199:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1183:27:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 133, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"baseExpression": {"id": 128, "name": "consecutiveWins", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 68, "src": "1213:15:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 131, "indexExpression": {"expression": {"id": 129, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1229:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 130, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1233:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "1229:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "1213:27:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": {"hexValue": "31", "id": 132, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1243:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_1_by_1", "typeString": "int_const 1"}, "value": "1"}, "src": "1213:31:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1183:61:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 135, "nodeType": "ExpressionStatement", "src": "1183:61:1"}]}}, {"eventCall": {"arguments": [{"expression": {"id": 147, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1342:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 148, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1346:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "1342:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, {"id": 149, "name": "guess", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 97, "src": "1354:5:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 150, "name": "num", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 101, "src": "1361:3:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 151, "name": "won", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 117, "src": "1366:3:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 146, "name": "BetPlaced", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 78, "src": "1332:9:1", "typeDescriptions": {"typeIdentifier": "t_function_event_nonpayable$_t_address_$_t_uint256_$_t_uint256_$_t_bool_$returns$__$", "typeString": "function (address,uint256,uint256,bool)"}}, "id": 152, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1332:38:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 153, "nodeType": "EmitStatement", "src": "1327:43:1"}, {"eventCall": {"arguments": [{"expression": {"id": 155, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1408:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 156, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1412:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "1408:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, {"baseExpression": {"id": 157, "name": "consecutiveWins", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 68, "src": "1420:15:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 160, "indexExpression": {"expression": {"id": 158, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1436:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 159, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1440:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "1436:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "1420:27:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_address", "typeString": "address"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}], "id": 154, "name": "ConsecutiveWinsUpdated", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 84, "src": "1385:22:1", "typeDescriptions": {"typeIdentifier": "t_function_event_nonpayable$_t_address_$_t_uint256_$returns$__$", "typeString": "function (address,uint256)"}}, "id": 161, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1385:63:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 162, "nodeType": "EmitStatement", "src": "1380:68:1"}]}, "documentation": {"id": 95, "nodeType": "StructuredDocumentation", "src": "556:393:1", "text": " @notice Place a bet\n @param guess The player's guess\n VULNERABILITY EXPLANATION:\n The \"random\" number is calculated as:\n   num = keccak256(seed, block.number) ^ 0x539\n Problem: block.number is PUBLIC information!\n - Anyone can read it\n - Anyone can calculate the same \"random\" number\n - Attackers can always win!"}, "functionSelector": "7365870b", "id": 164, "implemented": true, "kind": "function", "modifiers": [], "name": "bet", "nameLocation": "963:3:1", "nodeType": "FunctionDefinition", "parameters": {"id": 98, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 97, "mutability": "mutable", "name": "guess", "nameLocation": "975:5:1", "nodeType": "VariableDeclaration", "scope": 164, "src": "967:13:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 96, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "967:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "966:15:1"}, "returnParameters": {"id": 99, "nodeType": "ParameterList", "parameters": [], "src": "989:0:1"}, "scope": 236, "src": "954:501:1", "stateMutability": "nonpayable", "virtual": false, "visibility": "public"}, {"body": {"id": 204, "nodeType": "Block", "src": "1643:239:1", "statements": [{"condition": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 176, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"baseExpression": {"id": 171, "name": "consecutiveWins", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 68, "src": "1657:15:1", "typeDescriptions": {"typeIdentifier": "t_mapping$_t_address_$_t_uint256_$", "typeString": "mapping(address => uint256)"}}, "id": 174, "indexExpression": {"expression": {"id": 172, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "1673:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_message", "typeString": "msg"}}, "id": 173, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "1677:6:1", "memberName": "sender", "nodeType": "MemberAccess", "src": "1673:10:1", "typeDescriptions": {"typeIdentifier": "t_address", "typeString": "address"}}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "1657:27:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": {"hexValue": "31", "id": 175, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1687:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_1_by_1", "typeString": "int_const 1"}, "value": "1"}, "src": "1657:31:1", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 184, "nodeType": "IfStatement", "src": "1653:84:1", "trueBody": {"id": 183, "nodeType": "Block", "src": "1690:47:1", "statements": [{"expression": {"arguments": [{"hexValue": "30", "id": 180, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1724:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}], "id": 179, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "NewExpression", "src": "1711:12:1", "typeDescriptions": {"typeIdentifier": "t_function_objectcreation_pure$_t_uint256_$returns$_t_array$_t_uint16_$dyn_memory_ptr_$", "typeString": "function (uint256) pure returns (uint16[] memory)"}, "typeName": {"baseType": {"id": 177, "name": "uint16", "nodeType": "ElementaryTypeName", "src": "1715:6:1", "typeDescriptions": {"typeIdentifier": "t_uint16", "typeString": "uint16"}}, "id": 178, "nodeType": "ArrayTypeName", "src": "1715:8:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_storage_ptr", "typeString": "uint16[]"}}}, "id": 181, "isConstant": false, "isLValue": false, "isPure": true, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1711:15:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_memory_ptr", "typeString": "uint16[] memory"}}, "functionReturnParameters": 170, "id": 182, "nodeType": "Return", "src": "1704:22:1"}]}}, {"assignments": [189], "declarations": [{"constant": false, "id": 189, "mutability": "mutable", "name": "notDone", "nameLocation": "1802:7:1", "nodeType": "VariableDeclaration", "scope": 204, "src": "1786:23:1", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_memory_ptr", "typeString": "uint16[]"}, "typeName": {"baseType": {"id": 187, "name": "uint16", "nodeType": "ElementaryTypeName", "src": "1786:6:1", "typeDescriptions": {"typeIdentifier": "t_uint16", "typeString": "uint16"}}, "id": 188, "nodeType": "ArrayTypeName", "src": "1786:8:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_storage_ptr", "typeString": "uint16[]"}}, "visibility": "internal"}], "id": 195, "initialValue": {"arguments": [{"hexValue": "31", "id": 193, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1825:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_1_by_1", "typeString": "int_const 1"}, "value": "1"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_rational_1_by_1", "typeString": "int_const 1"}], "id": 192, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "NewExpression", "src": "1812:12:1", "typeDescriptions": {"typeIdentifier": "t_function_objectcreation_pure$_t_uint256_$returns$_t_array$_t_uint16_$dyn_memory_ptr_$", "typeString": "function (uint256) pure returns (uint16[] memory)"}, "typeName": {"baseType": {"id": 190, "name": "uint16", "nodeType": "ElementaryTypeName", "src": "1816:6:1", "typeDescriptions": {"typeIdentifier": "t_uint16", "typeString": "uint16"}}, "id": 191, "nodeType": "ArrayTypeName", "src": "1816:8:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_storage_ptr", "typeString": "uint16[]"}}}, "id": 194, "isConstant": false, "isLValue": false, "isPure": true, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "1812:15:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_memory_ptr", "typeString": "uint16[] memory"}}, "nodeType": "VariableDeclarationStatement", "src": "1786:41:1"}, {"expression": {"id": 200, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"baseExpression": {"id": 196, "name": "notDone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 189, "src": "1837:7:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_memory_ptr", "typeString": "uint16[] memory"}}, "id": 198, "indexExpression": {"hexValue": "30", "id": 197, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1845:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "IndexAccess", "src": "1837:10:1", "typeDescriptions": {"typeIdentifier": "t_uint16", "typeString": "uint16"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"hexValue": "31", "id": 199, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1850:1:1", "typeDescriptions": {"typeIdentifier": "t_rational_1_by_1", "typeString": "int_const 1"}, "value": "1"}, "src": "1837:14:1", "typeDescriptions": {"typeIdentifier": "t_uint16", "typeString": "uint16"}}, "id": 201, "nodeType": "ExpressionStatement", "src": "1837:14:1"}, {"expression": {"id": 202, "name": "notDone", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 189, "src": "1868:7:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_memory_ptr", "typeString": "uint16[] memory"}}, "functionReturnParameters": 170, "id": 203, "nodeType": "Return", "src": "1861:14:1"}]}, "documentation": {"id": 165, "nodeType": "StructuredDocumentation", "src": "1461:123:1", "text": " @notice Check if player has won enough times\n @return Empty array if player has won more than once"}, "functionSelector": "ae8421e1", "id": 205, "implemented": true, "kind": "function", "modifiers": [], "name": "done", "nameLocation": "1598:4:1", "nodeType": "FunctionDefinition", "parameters": {"id": 166, "nodeType": "ParameterList", "parameters": [], "src": "1602:2:1"}, "returnParameters": {"id": 170, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 169, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 205, "src": "1626:15:1", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_memory_ptr", "typeString": "uint16[]"}, "typeName": {"baseType": {"id": 167, "name": "uint16", "nodeType": "ElementaryTypeName", "src": "1626:6:1", "typeDescriptions": {"typeIdentifier": "t_uint16", "typeString": "uint16"}}, "id": 168, "nodeType": "ArrayTypeName", "src": "1626:8:1", "typeDescriptions": {"typeIdentifier": "t_array$_t_uint16_$dyn_storage_ptr", "typeString": "uint16[]"}}, "visibility": "internal"}], "src": "1625:17:1"}, "scope": 236, "src": "1589:293:1", "stateMutability": "view", "virtual": false, "visibility": "public"}, {"body": {"id": 213, "nodeType": "Block", "src": "2195:28:1", "statements": [{"expression": {"id": 211, "name": "seed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 64, "src": "2212:4:1", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}, "functionReturnParameters": 210, "id": 212, "nodeType": "Return", "src": "2205:11:1"}]}, "documentation": {"id": 206, "nodeType": "StructuredDocumentation", "src": "1888:253:1", "text": " @notice Get seed (for testing purposes)\n @dev In production, this would be truly private, but it ultimately\n      does not matter because block.number is public and contract\n      storage can always be read on-chain."}, "functionSelector": "39e7357c", "id": 214, "implemented": true, "kind": "function", "modifiers": [], "name": "getSeed", "nameLocation": "2155:7:1", "nodeType": "FunctionDefinition", "parameters": {"id": 207, "nodeType": "ParameterList", "parameters": [], "src": "2162:2:1"}, "returnParameters": {"id": 210, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 209, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 214, "src": "2186:7:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}, "typeName": {"id": 208, "name": "bytes32", "nodeType": "ElementaryTypeName", "src": "2186:7:1", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}, "visibility": "internal"}], "src": "2185:9:1"}, "scope": 236, "src": "2146:77:1", "stateMutability": "view", "virtual": false, "visibility": "public"}, {"body": {"id": 234, "nodeType": "Block", "src": "2428:88:1", "statements": [{"expression": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 232, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"arguments": [{"arguments": [{"arguments": [{"id": 225, "name": "seed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 64, "src": "2480:4:1", "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}, {"expression": {"id": 226, "name": "block", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -4, "src": "2486:5:1", "typeDescriptions": {"typeIdentifier": "t_magic_block", "typeString": "block"}}, "id": 227, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2492:6:1", "memberName": "number", "nodeType": "MemberAccess", "src": "2486:12:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bytes32", "typeString": "bytes32"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}], "expression": {"id": 223, "name": "abi", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -1, "src": "2463:3:1", "typeDescriptions": {"typeIdentifier": "t_magic_abi", "typeString": "abi"}}, "id": 224, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "2467:12:1", "memberName": "encodePacked", "nodeType": "MemberAccess", "src": "2463:16:1", "typeDescriptions": {"typeIdentifier": "t_function_abiencodepacked_pure$__$returns$_t_bytes_memory_ptr_$", "typeString": "function () pure returns (bytes memory)"}}, "id": 228, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2463:36:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_bytes_memory_ptr", "typeString": "bytes memory"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bytes_memory_ptr", "typeString": "bytes memory"}], "id": 222, "name": "keccak256", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -8, "src": "2453:9:1", "typeDescriptions": {"typeIdentifier": "t_function_keccak256_pure$_t_bytes_memory_ptr_$returns$_t_bytes32_$", "typeString": "function (bytes memory) pure returns (bytes32)"}}, "id": 229, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2453:47:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_bytes32", "typeString": "bytes32"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bytes32", "typeString": "bytes32"}], "id": 221, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "2445:7:1", "typeDescriptions": {"typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)"}, "typeName": {"id": 220, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2445:7:1", "typeDescriptions": {}}}, "id": 230, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2445:56:1", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "^", "rightExpression": {"hexValue": "3078353339", "id": 231, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "2504:5:1", "typeDescriptions": {"typeIdentifier": "t_rational_1337_by_1", "typeString": "int_const 1337"}, "value": "0x539"}, "src": "2445:64:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "functionReturnParameters": 219, "id": 233, "nodeType": "Return", "src": "2438:71:1"}]}, "documentation": {"id": 215, "nodeType": "StructuredDocumentation", "src": "2229:136:1", "text": " @notice Calculate the \"random\" number for current block\n @dev Exposes the vulnerability - anyone can call this!"}, "functionSelector": "5c2fbc3e", "id": 235, "implemented": true, "kind": "function", "modifiers": [], "name": "getCurrentNumber", "nameLocation": "2379:16:1", "nodeType": "FunctionDefinition", "parameters": {"id": 216, "nodeType": "ParameterList", "parameters": [], "src": "2395:2:1"}, "returnParameters": {"id": 219, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 218, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 235, "src": "2419:7:1", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 217, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2419:7:1", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "2418:9:1"}, "scope": 236, "src": "2370:146:1", "stateMutability": "view", "virtual": false, "visibility": "public"}], "scope": 237, "src": "220:2298:1", "usedErrors": [], "usedEvents": [78, 84]}], "src": "32:2487:1"}}}, "sourceList": ["/workspaces/evm-ctf-challenges/challenges/05-Casino/echidna/CasinoEchidna.sol", "/workspaces/evm-ctf-challenges/challenges/05-Casino/src/Casino.sol"], "contracts": {"/workspaces/evm-ctf-challenges/challenges/05-Casino/echidna/CasinoEchidna.sol:CasinoEchidna": {"srcmap": "189:766:0:-:0;;;257:52;;;;;;;;;;290:12;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;281:21;;;;;;;;;;189:766;;;;;;;;;;:::o;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;", "srcmap-runtime": "189:766:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;666:287;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;;715:4;731:13;747:6;:23;;;:25;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;731:41;;782:6;:10;;;793:5;782:17;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;810;830:6;:23;;;:25;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;810:45;;865:6;:10;;;876:9;865:21;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;945:1;904:6;:22;;;935:4;904:37;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:42;;897:49;;;;666:287;:::o;7:90:2:-;41:7;84:5;77:13;70:21;59:32;;7:90;;;:::o;103:109::-;184:21;199:5;184:21;:::i;:::-;179:3;172:34;103:109;;:::o;218:210::-;305:4;343:2;332:9;328:18;320:26;;356:65;418:1;407:9;403:17;394:6;356:65;:::i;:::-;218:210;;;;:::o;515:117::-;624:1;621;614:12;761:77;798:7;827:5;816:16;;761:77;;;:::o;844:122::-;917:24;935:5;917:24;:::i;:::-;910:5;907:35;897:63;;956:1;953;946:12;897:63;844:122;:::o;972:143::-;1029:5;1060:6;1054:13;1045:22;;1076:33;1103:5;1076:33;:::i;:::-;972:143;;;;:::o;1121:351::-;1191:6;1240:2;1228:9;1219:7;1215:23;1211:32;1208:119;;;1246:79;;:::i;:::-;1208:119;1366:1;1391:64;1447:7;1438:6;1427:9;1423:22;1391:64;:::i;:::-;1381:74;;1337:128;1121:351;;;;:::o;1478:118::-;1565:24;1583:5;1565:24;:::i;:::-;1560:3;1553:37;1478:118;;:::o;1602:222::-;1695:4;1733:2;1722:9;1718:18;1710:26;;1746:71;1814:1;1803:9;1799:17;1790:6;1746:71;:::i;:::-;1602:222;;;;:::o;1830:126::-;1867:7;1907:42;1900:5;1896:54;1885:65;;1830:126;;;:::o;1962:96::-;1999:7;2028:24;2046:5;2028:24;:::i;:::-;2017:35;;1962:96;;;:::o;2064:118::-;2151:24;2169:5;2151:24;:::i;:::-;2146:3;2139:37;2064:118;;:::o;2188:222::-;2281:4;2319:2;2308:9;2304:18;2296:26;;2332:71;2400:1;2389:9;2385:17;2376:6;2332:71;:::i;:::-;2188:222;;;;:::o", "abi": "[{\"inputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"constructor\"}, {\"inputs\": [], \"name\": \"echidna_no_double_win\", \"outputs\": [{\"internalType\": \"bool\", \"name\": \"\", \"type\": \"bool\"}], \"stateMutability\": \"nonpayable\", \"type\": \"function\"}]", "bin": "60a060405234801561000f575f5ffd5b5060405161001c9061006e565b604051809103905ff080158015610035573d5f5f3e3d5ffd5b5073ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff168152505061007b565b61086c8061051383390190565b6080516104666100ad5f395f8181604f0152818160de01528181610165015281816101f4015261027c01526104665ff3fe608060405234801561000f575f5ffd5b5060043610610029575f3560e01c806325c998d01461002d575b5f5ffd5b61003561004b565b6040516100429190610335565b60405180910390f35b5f5f7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16635c2fbc3e6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156100b6573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906100da9190610385565b90507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16637365870b826040518263ffffffff1660e01b815260040161013591906103bf565b5f604051808303815f87803b15801561014c575f5ffd5b505af115801561015e573d5f5f3e3d5ffd5b505050505f7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16635c2fbc3e6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156101cc573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101f09190610385565b90507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16637365870b826040518263ffffffff1660e01b815260040161024b91906103bf565b5f604051808303815f87803b158015610262575f5ffd5b505af1158015610274573d5f5f3e3d5ffd5b5050505060017f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1663143af907306040518263ffffffff1660e01b81526004016102d39190610417565b602060405180830381865afa1580156102ee573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103129190610385565b11159250505090565b5f8115159050919050565b61032f8161031b565b82525050565b5f6020820190506103485f830184610326565b92915050565b5f5ffd5b5f819050919050565b61036481610352565b811461036e575f5ffd5b50565b5f8151905061037f8161035b565b92915050565b5f6020828403121561039a5761039961034e565b5b5f6103a784828501610371565b91505092915050565b6103b981610352565b82525050565b5f6020820190506103d25f8301846103b0565b92915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610401826103d8565b9050919050565b610411816103f7565b82525050565b5f60208201905061042a5f830184610408565b9291505056fea2646970667358221220c9584dd7f784c34c033365a97e57229c4090e3a4d2cdfaaa06e6f9f3217e790164736f6c634300081e00336080604052348015600e575f5ffd5b507fb37c910f4e0df0efafb35a55489604369808b6de642ff1dbab5062680afaddcd5f8190555061082a806100425f395ff3fe608060405234801561000f575f5ffd5b5060043610610055575f3560e01c8063143af9071461005957806339e7357c146100895780635c2fbc3e146100a75780637365870b146100c5578063ae8421e1146100e1575b5f5ffd5b610073600480360381019061006e91906104ba565b6100ff565b60405161008091906104fd565b60405180910390f35b610091610114565b60405161009e919061052e565b60405180910390f35b6100af61011c565b6040516100bc91906104fd565b60405180910390f35b6100df60048036038101906100da9190610571565b610152565b005b6100e9610345565b6040516100f69190610660565b60405180910390f35b6001602052805f5260405f205f915090505481565b5f5f54905090565b5f6105395f54436040516020016101349291906106c0565b604051602081830303815290604052805190602001205f1c18905090565b5f6105395f544360405160200161016a9291906106c0565b604051602081830303815290604052805190602001205f1c1890505f81831490508015610220576001805f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20546101da9190610718565b60015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2081905550610263565b5f60015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055505b3373ffffffffffffffffffffffffffffffffffffffff167feecad545a2ea4b549fd96ca809f2218e8daec7f3214b4813f4cddbc406ea803e8484846040516102ad93929190610765565b60405180910390a23373ffffffffffffffffffffffffffffffffffffffff167f483411878b50197a889f082127b6949d36484c69160aa7f00ec428c9cee13f1760015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205460405161033891906104fd565b60405180910390a2505050565b60606001805f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205411156103dc575f67ffffffffffffffff8111156103a6576103a561079a565b5b6040519080825280602002602001820160405280156103d45781602001602082028036833780820191505090505b509050610459565b5f600167ffffffffffffffff8111156103f8576103f761079a565b5b6040519080825280602002602001820160405280156104265781602001602082028036833780820191505090505b5090506001815f8151811061043e5761043d6107c7565b5b602002602001019061ffff16908161ffff1681525050809150505b90565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61048982610460565b9050919050565b6104998161047f565b81146104a3575f5ffd5b50565b5f813590506104b481610490565b92915050565b5f602082840312156104cf576104ce61045c565b5b5f6104dc848285016104a6565b91505092915050565b5f819050919050565b6104f7816104e5565b82525050565b5f6020820190506105105f8301846104ee565b92915050565b5f819050919050565b61052881610516565b82525050565b5f6020820190506105415f83018461051f565b92915050565b610550816104e5565b811461055a575f5ffd5b50565b5f8135905061056b81610547565b92915050565b5f602082840312156105865761058561045c565b5b5f6105938482850161055d565b91505092915050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b5f61ffff82169050919050565b6105db816105c5565b82525050565b5f6105ec83836105d2565b60208301905092915050565b5f602082019050919050565b5f61060e8261059c565b61061881856105a6565b9350610623836105b6565b805f5b8381101561065357815161063a88826105e1565b9750610645836105f8565b925050600181019050610626565b5085935050505092915050565b5f6020820190508181035f8301526106788184610604565b905092915050565b5f819050919050565b61069a61069582610516565b610680565b82525050565b5f819050919050565b6106ba6106b5826104e5565b6106a0565b82525050565b5f6106cb8285610689565b6020820191506106db82846106a9565b6020820191508190509392505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f610722826104e5565b915061072d836104e5565b9250828201905080821115610745576107446106eb565b5b92915050565b5f8115159050919050565b61075f8161074b565b82525050565b5f6060820190506107785f8301866104ee565b61078560208301856104ee565b6107926040830184610756565b949350505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffdfea264697066735822122083c1c4023b2de0579aba3ccb35b9bd95e0cb1eba4bf7dd464b0cacdd945db60664736f6c634300081e0033", "bin-runtime": "608060405234801561000f575f5ffd5b5060043610610029575f3560e01c806325c998d01461002d575b5f5ffd5b61003561004b565b6040516100429190610335565b60405180910390f35b5f5f7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16635c2fbc3e6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156100b6573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906100da9190610385565b90507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16637365870b826040518263ffffffff1660e01b815260040161013591906103bf565b5f604051808303815f87803b15801561014c575f5ffd5b505af115801561015e573d5f5f3e3d5ffd5b505050505f7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16635c2fbc3e6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156101cc573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101f09190610385565b90507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16637365870b826040518263ffffffff1660e01b815260040161024b91906103bf565b5f604051808303815f87803b158015610262575f5ffd5b505af1158015610274573d5f5f3e3d5ffd5b5050505060017f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1663143af907306040518263ffffffff1660e01b81526004016102d39190610417565b602060405180830381865afa1580156102ee573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103129190610385565b11159250505090565b5f8115159050919050565b61032f8161031b565b82525050565b5f6020820190506103485f830184610326565b92915050565b5f5ffd5b5f819050919050565b61036481610352565b811461036e575f5ffd5b50565b5f8151905061037f8161035b565b92915050565b5f6020828403121561039a5761039961034e565b5b5f6103a784828501610371565b91505092915050565b6103b981610352565b82525050565b5f6020820190506103d25f8301846103b0565b92915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610401826103d8565b9050919050565b610411816103f7565b82525050565b5f60208201905061042a5f830184610408565b9291505056fea2646970667358221220c9584dd7f784c34c033365a97e57229c4090e3a4d2cdfaaa06e6f9f3217e790164736f6c634300081e0033", "userdoc": {"methods": {"echidna_no_double_win()": {"notice": "Invariant: a player should never exceed one consecutive win"}}, "notice": "Echidna harness that encodes the intended safety invariant"}, "devdoc": {"methods": {"echidna_no_double_win()": {"author": null, "details": "Each call places exactly one bet using the publicly exposed RNG value.      Echidna repeats calls, so on the second invocation consecutiveWins becomes 2      and the property fails, demonstrating the bug without bespoke helper flows.", "params": {}, "return": null}}, "author": null, "details": null, "title": "CasinoEchidna"}, "libraries": {}}, "/workspaces/evm-ctf-challenges/challenges/05-Casino/src/Casino.sol:Casino": {"srcmap": "220:2298:1:-:0;;;484:66;;;;;;;;;;515:28;508:4;:35;;;;220:2298;;;;;;", "srcmap-runtime": "220:2298:1:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;268:50;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;2146:77;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;2370:146;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;954:501;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;1589:293;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;268:50;;;;;;;;;;;;;;;;;:::o;2146:77::-;2186:7;2212:4;;2205:11;;2146:77;:::o;2370:146::-;2419:7;2504:5;2480:4;;2486:12;2463:36;;;;;;;;;:::i;:::-;;;;;;;;;;;;;2453:47;;;;;;2445:56;;:64;2438:71;;2370:146;:::o;954:501::-;1035:11;1108:5;1084:4;;1090:12;1067:36;;;;;;;;;:::i;:::-;;;;;;;;;;;;;1057:47;;;;;;1049:56;;:64;1035:78;;1124:8;1145:3;1136:5;:12;1124:25;;1164:3;1160:157;;;1243:1;1213:15;:27;1229:10;1213:27;;;;;;;;;;;;;;;;:31;;;;:::i;:::-;1183:15;:27;1199:10;1183:27;;;;;;;;;;;;;;;:61;;;;1160:157;;;1305:1;1275:15;:27;1291:10;1275:27;;;;;;;;;;;;;;;:31;;;;1160:157;1342:10;1332:38;;;1354:5;1361:3;1366;1332:38;;;;;;;;:::i;:::-;;;;;;;;1408:10;1385:63;;;1420:15;:27;1436:10;1420:27;;;;;;;;;;;;;;;;1385:63;;;;;;:::i;:::-;;;;;;;;989:466;;954:501;:::o;1589:293::-;1626:15;1687:1;1657:15;:27;1673:10;1657:27;;;;;;;;;;;;;;;;:31;1653:84;;;1724:1;1711:15;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1704:22;;;;1653:84;1786:23;1825:1;1812:15;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1786:41;;1850:1;1837:7;1845:1;1837:10;;;;;;;;:::i;:::-;;;;;;;:14;;;;;;;;;;;1868:7;1861:14;;;1589:293;;:::o;88:117:2:-;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:139::-;742:5;780:6;767:20;758:29;;796:33;823:5;796:33;:::i;:::-;696:139;;;;:::o;841:329::-;900:6;949:2;937:9;928:7;924:23;920:32;917:119;;;955:79;;:::i;:::-;917:119;1075:1;1100:53;1145:7;1136:6;1125:9;1121:22;1100:53;:::i;:::-;1090:63;;1046:117;841:329;;;;:::o;1176:77::-;1213:7;1242:5;1231:16;;1176:77;;;:::o;1259:118::-;1346:24;1364:5;1346:24;:::i;:::-;1341:3;1334:37;1259:118;;:::o;1383:222::-;1476:4;1514:2;1503:9;1499:18;1491:26;;1527:71;1595:1;1584:9;1580:17;1571:6;1527:71;:::i;:::-;1383:222;;;;:::o;1611:77::-;1648:7;1677:5;1666:16;;1611:77;;;:::o;1694:118::-;1781:24;1799:5;1781:24;:::i;:::-;1776:3;1769:37;1694:118;;:::o;1818:222::-;1911:4;1949:2;1938:9;1934:18;1926:26;;1962:71;2030:1;2019:9;2015:17;2006:6;1962:71;:::i;:::-;1818:222;;;;:::o;2046:122::-;2119:24;2137:5;2119:24;:::i;:::-;2112:5;2109:35;2099:63;;2158:1;2155;2148:12;2099:63;2046:122;:::o;2174:139::-;2220:5;2258:6;2245:20;2236:29;;2274:33;2301:5;2274:33;:::i;:::-;2174:139;;;;:::o;2319:329::-;2378:6;2427:2;2415:9;2406:7;2402:23;2398:32;2395:119;;;2433:79;;:::i;:::-;2395:119;2553:1;2578:53;2623:7;2614:6;2603:9;2599:22;2578:53;:::i;:::-;2568:63;;2524:117;2319:329;;;;:::o;2654:113::-;2720:6;2754:5;2748:12;2738:22;;2654:113;;;:::o;2773:183::-;2871:11;2905:6;2900:3;2893:19;2945:4;2940:3;2936:14;2921:29;;2773:183;;;;:::o;2962:131::-;3028:4;3051:3;3043:11;;3081:4;3076:3;3072:14;3064:22;;2962:131;;;:::o;3099:89::-;3135:7;3175:6;3168:5;3164:18;3153:29;;3099:89;;;:::o;3194:105::-;3269:23;3286:5;3269:23;:::i;:::-;3264:3;3257:36;3194:105;;:::o;3305:175::-;3372:10;3393:44;3433:3;3425:6;3393:44;:::i;:::-;3469:4;3464:3;3460:14;3446:28;;3305:175;;;;:::o;3486:112::-;3555:4;3587;3582:3;3578:14;3570:22;;3486:112;;;:::o;3632:724::-;3749:3;3778:53;3825:5;3778:53;:::i;:::-;3847:85;3925:6;3920:3;3847:85;:::i;:::-;3840:92;;3956:55;4005:5;3956:55;:::i;:::-;4034:7;4065:1;4050:281;4075:6;4072:1;4069:13;4050:281;;;4151:6;4145:13;4178:61;4235:3;4220:13;4178:61;:::i;:::-;4171:68;;4262:59;4314:6;4262:59;:::i;:::-;4252:69;;4110:221;4097:1;4094;4090:9;4085:14;;4050:281;;;4054:14;4347:3;4340:10;;3754:602;;;3632:724;;;;:::o;4362:369::-;4503:4;4541:2;4530:9;4526:18;4518:26;;4590:9;4584:4;4580:20;4576:1;4565:9;4561:17;4554:47;4618:106;4719:4;4710:6;4618:106;:::i;:::-;4610:114;;4362:369;;;;:::o;4737:79::-;4776:7;4805:5;4794:16;;4737:79;;;:::o;4822:157::-;4927:45;4947:24;4965:5;4947:24;:::i;:::-;4927:45;:::i;:::-;4922:3;4915:58;4822:157;;:::o;4985:79::-;5024:7;5053:5;5042:16;;4985:79;;;:::o;5070:157::-;5175:45;5195:24;5213:5;5195:24;:::i;:::-;5175:45;:::i;:::-;5170:3;5163:58;5070:157;;:::o;5233:397::-;5373:3;5388:75;5459:3;5450:6;5388:75;:::i;:::-;5488:2;5483:3;5479:12;5472:19;;5501:75;5572:3;5563:6;5501:75;:::i;:::-;5601:2;5596:3;5592:12;5585:19;;5621:3;5614:10;;5233:397;;;;;:::o;5636:180::-;5684:77;5681:1;5674:88;5781:4;5778:1;5771:15;5805:4;5802:1;5795:15;5822:191;5862:3;5881:20;5899:1;5881:20;:::i;:::-;5876:25;;5915:20;5933:1;5915:20;:::i;:::-;5910:25;;5958:1;5955;5951:9;5944:16;;5979:3;5976:1;5973:10;5970:36;;;5986:18;;:::i;:::-;5970:36;5822:191;;;;:::o;6019:90::-;6053:7;6096:5;6089:13;6082:21;6071:32;;6019:90;;;:::o;6115:109::-;6196:21;6211:5;6196:21;:::i;:::-;6191:3;6184:34;6115:109;;:::o;6230:430::-;6373:4;6411:2;6400:9;6396:18;6388:26;;6424:71;6492:1;6481:9;6477:17;6468:6;6424:71;:::i;:::-;6505:72;6573:2;6562:9;6558:18;6549:6;6505:72;:::i;:::-;6587:66;6649:2;6638:9;6634:18;6625:6;6587:66;:::i;:::-;6230:430;;;;;;:::o;6666:180::-;6714:77;6711:1;6704:88;6811:4;6808:1;6801:15;6835:4;6832:1;6825:15;6852:180;6900:77;6897:1;6890:88;6997:4;6994:1;6987:15;7021:4;7018:1;7011:15", "abi": "[{\"inputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"constructor\"}, {\"anonymous\": false, \"inputs\": [{\"indexed\": true, \"internalType\": \"address\", \"name\": \"player\", \"type\": \"address\"}, {\"indexed\": false, \"internalType\": \"uint256\", \"name\": \"guess\", \"type\": \"uint256\"}, {\"indexed\": false, \"internalType\": \"uint256\", \"name\": \"result\", \"type\": \"uint256\"}, {\"indexed\": false, \"internalType\": \"bool\", \"name\": \"won\", \"type\": \"bool\"}], \"name\": \"BetPlaced\", \"type\": \"event\"}, {\"anonymous\": false, \"inputs\": [{\"indexed\": true, \"internalType\": \"address\", \"name\": \"player\", \"type\": \"address\"}, {\"indexed\": false, \"internalType\": \"uint256\", \"name\": \"wins\", \"type\": \"uint256\"}], \"name\": \"ConsecutiveWinsUpdated\", \"type\": \"event\"}, {\"inputs\": [{\"internalType\": \"uint256\", \"name\": \"guess\", \"type\": \"uint256\"}], \"name\": \"bet\", \"outputs\": [], \"stateMutability\": \"nonpayable\", \"type\": \"function\"}, {\"inputs\": [{\"internalType\": \"address\", \"name\": \"\", \"type\": \"address\"}], \"name\": \"consecutiveWins\", \"outputs\": [{\"internalType\": \"uint256\", \"name\": \"\", \"type\": \"uint256\"}], \"stateMutability\": \"view\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"done\", \"outputs\": [{\"internalType\": \"uint16[]\", \"name\": \"\", \"type\": \"uint16[]\"}], \"stateMutability\": \"view\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"getCurrentNumber\", \"outputs\": [{\"internalType\": \"uint256\", \"name\": \"\", \"type\": \"uint256\"}], \"stateMutability\": \"view\", \"type\": \"function\"}, {\"inputs\": [], \"name\": \"getSeed\", \"outputs\": [{\"internalType\": \"bytes32\", \"name\": \"\", \"type\": \"bytes32\"}], \"stateMutability\": \"view\", \"type\": \"function\"}]", "bin": "6080604052348015600e575f5ffd5b507fb37c910f4e0df0efafb35a55489604369808b6de642ff1dbab5062680afaddcd5f8190555061082a806100425f395ff3fe608060405234801561000f575f5ffd5b5060043610610055575f3560e01c8063143af9071461005957806339e7357c146100895780635c2fbc3e146100a75780637365870b146100c5578063ae8421e1146100e1575b5f5ffd5b610073600480360381019061006e91906104ba565b6100ff565b60405161008091906104fd565b60405180910390f35b610091610114565b60405161009e919061052e565b60405180910390f35b6100af61011c565b6040516100bc91906104fd565b60405180910390f35b6100df60048036038101906100da9190610571565b610152565b005b6100e9610345565b6040516100f69190610660565b60405180910390f35b6001602052805f5260405f205f915090505481565b5f5f54905090565b5f6105395f54436040516020016101349291906106c0565b604051602081830303815290604052805190602001205f1c18905090565b5f6105395f544360405160200161016a9291906106c0565b604051602081830303815290604052805190602001205f1c1890505f81831490508015610220576001805f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20546101da9190610718565b60015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2081905550610263565b5f60015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055505b3373ffffffffffffffffffffffffffffffffffffffff167feecad545a2ea4b549fd96ca809f2218e8daec7f3214b4813f4cddbc406ea803e8484846040516102ad93929190610765565b60405180910390a23373ffffffffffffffffffffffffffffffffffffffff167f483411878b50197a889f082127b6949d36484c69160aa7f00ec428c9cee13f1760015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205460405161033891906104fd565b60405180910390a2505050565b60606001805f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205411156103dc575f67ffffffffffffffff8111156103a6576103a561079a565b5b6040519080825280602002602001820160405280156103d45781602001602082028036833780820191505090505b509050610459565b5f600167ffffffffffffffff8111156103f8576103f761079a565b5b6040519080825280602002602001820160405280156104265781602001602082028036833780820191505090505b5090506001815f8151811061043e5761043d6107c7565b5b602002602001019061ffff16908161ffff1681525050809150505b90565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61048982610460565b9050919050565b6104998161047f565b81146104a3575f5ffd5b50565b5f813590506104b481610490565b92915050565b5f602082840312156104cf576104ce61045c565b5b5f6104dc848285016104a6565b91505092915050565b5f819050919050565b6104f7816104e5565b82525050565b5f6020820190506105105f8301846104ee565b92915050565b5f819050919050565b61052881610516565b82525050565b5f6020820190506105415f83018461051f565b92915050565b610550816104e5565b811461055a575f5ffd5b50565b5f8135905061056b81610547565b92915050565b5f602082840312156105865761058561045c565b5b5f6105938482850161055d565b91505092915050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b5f61ffff82169050919050565b6105db816105c5565b82525050565b5f6105ec83836105d2565b60208301905092915050565b5f602082019050919050565b5f61060e8261059c565b61061881856105a6565b9350610623836105b6565b805f5b8381101561065357815161063a88826105e1565b9750610645836105f8565b925050600181019050610626565b5085935050505092915050565b5f6020820190508181035f8301526106788184610604565b905092915050565b5f819050919050565b61069a61069582610516565b610680565b82525050565b5f819050919050565b6106ba6106b5826104e5565b6106a0565b82525050565b5f6106cb8285610689565b6020820191506106db82846106a9565b6020820191508190509392505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f610722826104e5565b915061072d836104e5565b9250828201905080821115610745576107446106eb565b5b92915050565b5f8115159050919050565b61075f8161074b565b82525050565b5f6060820190506107785f8301866104ee565b61078560208301856104ee565b6107926040830184610756565b949350505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffdfea264697066735822122083c1c4023b2de0579aba3ccb35b9bd95e0cb1eba4bf7dd464b0cacdd945db60664736f6c634300081e0033", "bin-runtime": "608060405234801561000f575f5ffd5b5060043610610055575f3560e01c8063143af9071461005957806339e7357c146100895780635c2fbc3e146100a75780637365870b146100c5578063ae8421e1146100e1575b5f5ffd5b610073600480360381019061006e91906104ba565b6100ff565b60405161008091906104fd565b60405180910390f35b610091610114565b60405161009e919061052e565b60405180910390f35b6100af61011c565b6040516100bc91906104fd565b60405180910390f35b6100df60048036038101906100da9190610571565b610152565b005b6100e9610345565b6040516100f69190610660565b60405180910390f35b6001602052805f5260405f205f915090505481565b5f5f54905090565b5f6105395f54436040516020016101349291906106c0565b604051602081830303815290604052805190602001205f1c18905090565b5f6105395f544360405160200161016a9291906106c0565b604051602081830303815290604052805190602001205f1c1890505f81831490508015610220576001805f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20546101da9190610718565b60015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2081905550610263565b5f60015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055505b3373ffffffffffffffffffffffffffffffffffffffff167feecad545a2ea4b549fd96ca809f2218e8daec7f3214b4813f4cddbc406ea803e8484846040516102ad93929190610765565b60405180910390a23373ffffffffffffffffffffffffffffffffffffffff167f483411878b50197a889f082127b6949d36484c69160aa7f00ec428c9cee13f1760015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205460405161033891906104fd565b60405180910390a2505050565b60606001805f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205411156103dc575f67ffffffffffffffff8111156103a6576103a561079a565b5b6040519080825280602002602001820160405280156103d45781602001602082028036833780820191505090505b509050610459565b5f600167ffffffffffffffff8111156103f8576103f761079a565b5b6040519080825280602002602001820160405280156104265781602001602082028036833780820191505090505b5090506001815f8151811061043e5761043d6107c7565b5b602002602001019061ffff16908161ffff1681525050809150505b90565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61048982610460565b9050919050565b6104998161047f565b81146104a3575f5ffd5b50565b5f813590506104b481610490565b92915050565b5f602082840312156104cf576104ce61045c565b5b5f6104dc848285016104a6565b91505092915050565b5f819050919050565b6104f7816104e5565b82525050565b5f6020820190506105105f8301846104ee565b92915050565b5f819050919050565b61052881610516565b82525050565b5f6020820190506105415f83018461051f565b92915050565b610550816104e5565b811461055a575f5ffd5b50565b5f8135905061056b81610547565b92915050565b5f602082840312156105865761058561045c565b5b5f6105938482850161055d565b91505092915050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b5f61ffff82169050919050565b6105db816105c5565b82525050565b5f6105ec83836105d2565b60208301905092915050565b5f602082019050919050565b5f61060e8261059c565b61061881856105a6565b9350610623836105b6565b805f5b8381101561065357815161063a88826105e1565b9750610645836105f8565b925050600181019050610626565b5085935050505092915050565b5f6020820190508181035f8301526106788184610604565b905092915050565b5f819050919050565b61069a61069582610516565b610680565b82525050565b5f819050919050565b6106ba6106b5826104e5565b6106a0565b82525050565b5f6106cb8285610689565b6020820191506106db82846106a9565b6020820191508190509392505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f610722826104e5565b915061072d836104e5565b9250828201905080821115610745576107446106eb565b5b92915050565b5f8115159050919050565b61075f8161074b565b82525050565b5f6060820190506107785f8301866104ee565b61078560208301856104ee565b6107926040830184610756565b949350505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffdfea264697066735822122083c1c4023b2de0579aba3ccb35b9bd95e0cb1eba4bf7dd464b0cacdd945db60664736f6c634300081e0033", "userdoc": {"methods": {"bet(uint256)": {"notice": "Place a bet"}, "done()": {"notice": "Check if player has won enough times"}, "getCurrentNumber()": {"notice": "Calculate the \"random\" number for current block"}, "getSeed()": {"notice": "Get seed (for testing purposes)"}}, "notice": "Vulnerable casino contract with predictable randomness"}, "devdoc": {"methods": {"bet(uint256)": {"author": null, "details": null, "params": {"guess": "The player's guess VULNERABILITY EXPLANATION: The \"random\" number is calculated as:   num = keccak256(seed, block.number) ^ 0x539 Problem: block.number is PUBLIC information! - Anyone can read it - Anyone can calculate the same \"random\" number - Attackers can always win!"}, "return": null}, "done()": {"author": null, "details": null, "params": {}, "return": null}, "getCurrentNumber()": {"author": null, "details": "Exposes the vulnerability - anyone can call this!", "params": {}, "return": null}, "getSeed()": {"author": null, "details": "In production, this would be truly private, but it ultimately      does not matter because block.number is public and contract      storage can always be read on-chain.", "params": {}, "return": null}}, "author": null, "details": "DO NOT USE IN PRODUCTION - Contains critical RNG vulnerability", "title": "Casino"}, "libraries": {}}}}